angular.module("demoApp",["br.weeklyScheduler","ngMaterial"]).controller("DemoController",["$q","$scope","$timeout","$log","$mdDialog",function(e,t,r,n,i){t.model={options:{buttonClasses:["wow!"],createItem:function(e,t){return new DemoItem(e,t)},defaultValue:!1,editSlot:function(t){return t.$isDeleting=!0,e.when(t)},fillEmptyWithDefault:!0,interval:900,maxTimeSlot:3600,minimumSeparation:300,onChange:function(e){},restrictionExplanations:{maxTimeSlot:function(e){return"Slots cannot be longer than "+e+"!"}},saveScheduler:function(){return t.result=t.adapter.getSnapshot(),e.when(!0)},scheduleCountOptions:{count:2}}},t.model.options.nullEnds=!0,t.adapter=new DemoAdapter([{day:5,start:3600,end:null,value:!0}])}]);var DemoItem=function(){function e(e,t){this.day=e,this.schedules=t}return Object.defineProperty(e.prototype,"editable",{get:function(){return!0},enumerable:!0,configurable:!0}),e}(),DemoAdapter=function(){function e(e){this.initialData=e,this.items=[]}return e.prototype.getSnapshot=function(){return Array.prototype.concat.apply([],this.items.map(function(e){return e.schedules.map(function(e){return{day:e.day,start:e.start,end:e.end,value:e.value}})}))},e.prototype.customModelToWeeklySchedulerRange=function(e){return e.$class="test",e},e}();angular.module("br.weeklyScheduler",["ngWeeklySchedulerTemplates"]);var AdapterService=function(){function e(e,t){this.groupService=e,this.itemFactory=t}return e.prototype.getItemsFromAdapter=function(e,t){var r=[];if(t){var n=t.initialData.map(function(e){return t.customModelToWeeklySchedulerRange(e)}),i=this.groupService.groupSchedules(n);for(var o in i){var l=this.itemFactory.createItem(e,parseInt(o,10),i[o]);r.push(l)}}return r},e.$name="brWeeklySchedulerAdapterService",e.$inject=["brWeeklySchedulerGroupService","brWeeklySchedulerItemFactory"],e}();angular.module("br.weeklyScheduler").service(AdapterService.$name,AdapterService);var ConfigurationService=function(){function e(e){this.timeConstants=e}return e.prototype.getConfiguration=function(e){var t=e.interval||900,r=this.timeConstants.SECONDS_IN_DAY/t,n=this.getDefaultOptions(),i=angular.merge(n,e);return angular.extend(i,{interval:t,maxValue:this.timeConstants.SECONDS_IN_DAY,hourCount:this.timeConstants.HOURS_IN_DAY,intervalCount:r})},e.prototype.getDefaultOptions=function(){return{createItem:function(e,t){return{day:e,schedules:t}},monoSchedule:!1,onChange:function(){return angular.noop()},onRemove:function(){return angular.noop()},restrictionExplanations:{maxTimeSlot:function(e){return"Max time slot length: "+e},minimumSeparation:function(e){return"Slots must be at least "+e+" apart!"},fullCalendar:"For this calendar, every day must be completely full of schedules.",monoSchedule:"This calendar may only have one time slot per day",nullEnds:"Items in this calendar do not have end times. Scheduled events begin at the start time and end when they are finished.",scheduleCount:function(e){var t="slot"+(1===e.count?"":"s");return e.exact?"This calendar must have exactly "+e.count+" "+t+" per day":"This calendar may only have a maximum of "+e.count+" "+t+" per day"}},scheduleCountOptions:{count:null,exact:!1}}},e.$name="brWeeklySchedulerConfigurationService",e.$inject=["brWeeklySchedulerTimeConstantsService"],e}();angular.module("br.weeklyScheduler").service(ConfigurationService.$name,ConfigurationService);var ConflictingOptionsService=function(){function e(){}return e.prototype.getConflictingOptions=function(e){return e.nullEnds&&e.scheduleCountOptions.count>1?"A nullEnds calendar has a maximum scheduleCount of 1":e.fullCalendar&&e.fillEmptyWithDefault?"Options 'fullCalendar' & 'fillEmptyWithDefault' are mutually exclusive.":e.fillEmptyWithDefault&&!angular.isDefined(e.defaultValue)?"If using option 'fillEmptyWithDefault', you must also provide 'defaultValue.'":""},e.$name="brWeeklySchedulerConflictingOptionsService",e}();angular.module("br.weeklyScheduler").service(ConflictingOptionsService.$name,ConflictingOptionsService);var DragService=function(){function e(e,t,r){this.endAdjusterService=e,this.nullEndWidth=t,this.rangeFactory=r}return e.prototype.getDragRangeFromSchedule=function(e,t){return this.rangeFactory.createRange(e,{day:t.day,start:t.start,end:e.nullEnds?this.endAdjusterService.adjustEndForView(e,t.start+this.nullEndWidth):this.endAdjusterService.adjustEndForView(e,t.end),value:t.value})},e.$name="brWeeklySchedulerDragService",e.$inject=["brWeeklySchedulerEndAdjusterService","brWeeklySchedulerNullEndWidth","brWeeklySchedulerRangeFactory"],e}();angular.module("br.weeklyScheduler").service(DragService.$name,DragService);var ElementOffsetService=function(){function e(){}return e.prototype.left=function(e){return e[0].getBoundingClientRect().left},e.prototype.right=function(e){return e[0].getBoundingClientRect().right},e.$name="brWeeklySchedulerElementOffsetService",e}();angular.module("br.weeklyScheduler").service(ElementOffsetService.$name,ElementOffsetService);var EndAdjusterService=function(){function e(){}return e.prototype.adjustEndForModel=function(e,t){return t===e.maxValue?0:t},e.prototype.adjustEndForView=function(e,t){return 0===t?e.maxValue:t},e.$name="brWeeklySchedulerEndAdjusterService",e}();angular.module("br.weeklyScheduler").service(EndAdjusterService.$name,EndAdjusterService);var FillEmptyWithDefaultService=function(){function e(e,t){this.endAdjusterService=e,this.rangeFactory=t}return e.prototype.fill=function(e,t){var r=e.schedules;return r.length?this.getFilledSchedules(r,t):[this.getEmptySchedule(e,t)]},e.prototype.getEmptySchedule=function(e,t){return this.rangeFactory.createRange(t,{day:e.day,start:0,end:this.endAdjusterService.adjustEndForModel(t,t.maxValue),value:t.defaultValue})},e.prototype.getEndSchedule=function(e,t){return this.rangeFactory.createRange(t,{day:e.day,start:e.end,end:this.endAdjusterService.adjustEndForModel(t,t.maxValue),value:t.defaultValue})},e.prototype.getStartSchedule=function(e,t){return this.rangeFactory.createRange(t,{day:e.day,start:0,end:e.start,value:t.defaultValue})},e.prototype.getFilledSchedulesForSingleSchedule=function(e,t){this.shouldFillNullEnd(e,t)&&(e.end=this.getNullEndValue(e,t));var r=[e];return this.scheduleTouchesStart(e,t)||r.push(this.getStartSchedule(e,t)),this.scheduleTouchesEnd(e,t)||r.push(this.getEndSchedule(e,t)),this.getSortedSchedules(r)},e.prototype.getFilledSchedules=function(e,t){if(1===(e=this.getSortedSchedules(e)).length)return this.getFilledSchedulesForSingleSchedule(e[0],t);for(var r=e.length-1,n=0;n<r;n++){var i=e[n],o=e[n+1];if(0==n&&!this.scheduleTouchesStart(i,t)){var l=this.getStartSchedule(i,t);e.push(l)}if(!this.schedulesTouch(i,o)){var a=this.getNewSchedule(i,o,t);e.push(a)}if(n==r-1&&!this.scheduleTouchesEnd(o,t)){var u=this.getEndSchedule(o,t);e.push(u);break}}return this.getSortedSchedules(e)},e.prototype.getNewSchedule=function(e,t,r){return this.rangeFactory.createRange(r,{day:e.day,start:e.end,end:t.start,value:r.defaultValue})},e.prototype.getNullEndValue=function(e,t){return e.start+t.maxTimeSlot},e.prototype.getSortedSchedules=function(e){return e.sort(function(e,t){return e.start-t.start})},e.prototype.schedulesTouch=function(e,t){return e.end===t.start},e.prototype.scheduleTouchesStart=function(e,t){return 0===e.start},e.prototype.scheduleTouchesEnd=function(e,t){return e.end===this.endAdjusterService.adjustEndForModel(t,t.maxValue)},e.prototype.shouldFillNullEnd=function(e,t){return null===e.end&&t.nullEnds&&t.maxTimeSlot},e.$name="brWeeklySchedulerFillEmptyWithDefaultService",e.$inject=["brWeeklySchedulerEndAdjusterService","brWeeklySchedulerRangeFactory"],e}();angular.module("br.weeklyScheduler").service(FillEmptyWithDefaultService.$name,FillEmptyWithDefaultService);var FullCalendarDirective=function(){function e(e){var t=this;this.validator=e,this.link=function(e,r,n,i){n.brFullCalendar&&(i.$validators[t.validator.error]=function(e){return t.validator.validate(e.schedules,e.config)})},this.require="ngModel"}return e.Factory=function(){var t=function(t){return new e(t)};return t.$inject=["brWeeklySchedulerFullCalendarValidatorService"],t},e.$name="brFullCalendar",e}();angular.module("br.weeklyScheduler").directive(FullCalendarDirective.$name,FullCalendarDirective.Factory());var GhostSlotController=function(){function e(e){this.$element=e}return e.$name="brGhostSlotController",e.$controllerAs="ghostSlotCtrl",e.$inject=["$element"],e}(),GhostSlotComponent=function(){function e(){this.controller=GhostSlotController.$name,this.controllerAs=GhostSlotController.$controllerAs,this.require={multiSliderCtrl:"^brMultiSlider"},this.template='\n        <ng-transclude class="fullWidth"></ng-transclude>\n    ',this.transclude=!0}return e.$name="brGhostSlot",e}();angular.module("br.weeklyScheduler").controller(GhostSlotController.$name,GhostSlotController).component(GhostSlotComponent.$name,new GhostSlotComponent);var GroupService=function(){function e(){}return e.prototype.groupSchedules=function(e){return e.reduce(function(e,t,r,n){var i=t.day;return e[i]||(e[i]=[]),e[i].push(t),e},{})},e.$name="brWeeklySchedulerGroupService",e}();angular.module("br.weeklyScheduler").service(GroupService.$name,GroupService);var HandleDirective=function(){function e(e,t,r){var n=this;this.$document=e,this.mouseTrackerService=t,this.touchService=r,this.restrict="A",this.scope={ondrag:"&",ondragstop:"&",ondragstart:"&",immediate:"<"},this.link=function(e,t){var r=n.$document,i=n.mouseTrackerService,o=n.touchService,l=0,a="mousemove touchmove",u="mouseup touchend";function s(e){return e.pageX||o.getPageX(e)}function c(t){var r=s(t)-l;angular.isFunction(e.ondrag)&&e.$apply(e.ondrag({delta:r}))}function d(){r.unbind(a,c),r.unbind(u,d),angular.isFunction(e.ondragstop)&&e.$apply(e.ondragstop())}function h(){r.on(a,c),r.on(u,d),angular.isFunction(e.ondragstart)&&e.$applyAsync(e.ondragstart())}t.on("mousedown touchstart",function(e){l=s(e),e.preventDefault(),e.stopPropagation(),h()}),e.immediate&&(l=i.getMousePosition().x,h())}}return e.Factory=function(){var t=function(t,r,n){return new e(t,r,n)};return t.$inject=["$document","brWeeklySchedulerMouseTrackerService","brWeeklySchedulerTouchService"],t},e.$name="brHandle",e}();angular.module("br.weeklyScheduler").directive(HandleDirective.$name,HandleDirective.Factory());var HourlyGridDirective=function(){function e(e){var t=this;this.timeConstants=e,this.restrict="E",this.require="^brWeeklyScheduler",this.GRID_TEMPLATE=angular.element('<div class="grid-item"></div>'),this.link=function(e,r,n,i){i.config&&t.doGrid(e,r,n,i.config)}}return e.prototype.handleClickEvent=function(e,t,r,n){e.bind("click",function(){n.$apply(function(){n.$emit("brWeeklyScheduler.clickOnACell",{nbElements:t,idx:r})})})},e.prototype.doGrid=function(e,t,r,n){var i=n.hourCount,o=this.GRID_TEMPLATE.clone();t.empty(),t.addClass("striped");for(var l=0;l<i;l++){var a=o.clone();if(angular.isUndefined(r.noText)){this.handleClickEvent(a,i,l,e);var u=l%12,s=l>=12?"p":"a";a.text(""+(u||"12")+s)}else for(var c=this.timeConstants.SECONDS_IN_HOUR/n.interval,d=100/c,h=0;h<c;h++){var m=this.GRID_TEMPLATE.clone();m.attr("rel",(l*c+h)*n.interval),m.addClass("interval"),m.css("width",d+"%"),a.append(m)}t.append(a)}},e.Factory=function(){var t=function(t){return new e(t)};return t.$inject=["brWeeklySchedulerTimeConstantsService"],t},e.$name="brHourlyGrid",e}();angular.module("br.weeklyScheduler").directive(HourlyGridDirective.$name,HourlyGridDirective.Factory());var LastGhostDayService=function(){function e(){}return e.prototype.getLastGhostDay=function(e){var t=this.getOriginIndex(e),r=this.getRenderedGhostIndices(e);return r[r.every(function(e){return e<=t})?0:r.length-1]},e.prototype.getOriginIndex=function(e){for(var t,r=e.length,n=0;n<r;n++){if(e[n].$isGhostOrigin){t=n;break}}return t},e.prototype.getRenderedGhostIndices=function(e){for(var t=[],r=e.length,n=0;n<r;n++){e[n].$renderGhost&&t.push(n)}return t},e.$name="brWeeklySchedulerLastGhostDayService",e}();angular.module("br.weeklyScheduler").service(LastGhostDayService.$name,LastGhostDayService);var MaxTimeSlotDirective=function(){function e(e){var t=this;this.validator=e,this.link=function(e,r,n,i){n.brMaxTimeSlot&&(i.$validators[t.validator.error]=function(e){return t.validator.validate(e.schedules,e.config)})},this.require="ngModel"}return e.Factory=function(){var t=function(t){return new e(t)};return t.$inject=["brWeeklySchedulerMaxTimeSlotValidatorService"],t},e.$name="brMaxTimeSlot",e}();angular.module("br.weeklyScheduler").directive(MaxTimeSlotDirective.$name,MaxTimeSlotDirective.Factory());var MinimumSeparationDirective=function(){function e(e){var t=this;this.validator=e,this.link=function(e,r,n,i){n.brMinimumSeparation&&(i.$validators[t.validator.error]=function(e){return t.validator.validate(e.schedules,e.config)})},this.require="ngModel"}return e.Factory=function(){var t=function(t){return new e(t)};return t.$inject=["brWeeklySchedulerMinimumSeparationValidatorService"],t},e.$name="brMinimumSeparation",e}();angular.module("br.weeklyScheduler").directive(MinimumSeparationDirective.$name,MinimumSeparationDirective.Factory());var MissingDaysService=function(){function e(e,t){this.dayMap=e,this.itemFactory=t}return e.prototype.fillItems=function(e,t){var r=this,n=[];return angular.forEach(this.dayMap,function(i,o){var l=parseInt(o,10),a=t.filter(function(e){return e.day===l}),u=a.length?a[0]:null;u?(u.label=i,n.push(u)):n.push(r.itemFactory.createItem(e,l,[]))}),angular.copy(n).sort(function(e,t){return e.day-t.day})},e.$name="brWeeklySchedulerMissingDaysService",e.$inject=["brWeeklySchedulerDayMap","brWeeklySchedulerItemFactory"],e}();angular.module("br.weeklyScheduler").service(MissingDaysService.$name,MissingDaysService);var MonoScheduleDirective=function(){function e(e){var t=this;this.validator=e,this.link=function(e,r,n,i){n.brMonoSchedule&&(i.$validators[t.validator.error]=function(e){return t.validator.validate(e.schedules,e.config)})},this.require="ngModel"}return e.Factory=function(){var t=function(t){return new e(t)};return t.$inject=["brWeeklySchedulerMonoScheduleValidatorService"],t},e.$name="brMonoSchedule",e}();angular.module("br.weeklyScheduler").directive(MonoScheduleDirective.$name,MonoScheduleDirective.Factory());var MouseTrackerService=function(){function e(e){this.$document=e}return e.prototype.initialize=function(){var e=this.setMousePosition.bind(this);this.$document.unbind("mousemove touchmove",e),this.$document.on("mousemove touchmove",e)},e.prototype.getMousePosition=function(){return this.mousePosition},e.prototype.setMousePosition=function(e){this.mousePosition={x:e.pageX,y:e.pageY}},e.$name="brWeeklySchedulerMouseTrackerService",e.$inject=["$document"],e}();angular.module("br.weeklyScheduler").service(MouseTrackerService.$name,MouseTrackerService).run([MouseTrackerService.$name,function(e){e.initialize()}]);var MultiSliderController=function(){function e(e,t,r,n,i,o,l,a,u){this.$element=e,this.$q=t,this.$scope=r,this.elementOffsetService=n,this.endAdjusterService=i,this.mouseTrackerService=o,this.nullEndWidth=l,this.rangeFactory=a,this.valueNormalizationService=u,this.element=this.$element[0]}return e.prototype.$postLink=function(){var e=this;this.$element.on("mouseenter",function(){e.onMouseEnter()}),this.$element.on("mouseleave",function(){e.onMouseLeave()}),this.$element.on("mouseup",function(){e.onMouseUp()}),this.$scope.$on("brWeeklyScheduler.commitGhost",function(t,r){e.item.$renderGhost&&e.commitGhost(r)}),this.$scope.$on("brWeeklyScheduler.removeGhost",function(t,r){e.item.$isGhostOrigin||e.item.day!==r||e.removeGhost()}),this.$scope.$on("brWeeklyScheduler.removeAllGhosts",function(){e.removeGhost()})},e.prototype.onMouseEnter=function(){this.item.$renderGhost&&this.$scope.$emit("brWeeklyScheduler.removeLastGhost"),this.dragSchedule&&this.addDragSchedule(),this.ghostValues&&!this.item.$renderGhost&&this.createGhost()},e.prototype.onMouseLeave=function(){this.dragSchedule&&this.removeDragSchedule()},e.prototype.onMouseUp=function(){this.pendingSchedule&&this.commitDragSchedule()},e.prototype.addDragSchedule=function(){this.dragSchedule.day=this.item.day,this.pendingSchedule=this.item.addSchedule(this.dragSchedule),this.pendingSchedule.$isActive=!0},e.prototype.removeDragSchedule=function(){this.item.removeSchedule(this.dragSchedule),this.ngModelCtrl.$setDirty(),this.pendingSchedule=null},e.prototype.commitDragSchedule=function(){this.pendingSchedule.$isActive=!1,this.ngModelCtrl.$setDirty(),this.item.mergeSchedule(this.pendingSchedule),this.pendingSchedule=null},e.prototype.getScheduleForAdd=function(e,t){return e=this.valueNormalizationService.normalizeValue(e,0,t),t=this.valueNormalizationService.normalizeValue(t,e,this.config.maxValue),this.config.nullEnds&&(t=null),{day:this.item.day,start:e,end:t,value:this.config.defaultValue}},e.prototype.openEditorForAdd=function(e){return this.item.canEdit()?this.config.editSlot(e):this.$q.when(e)},e.prototype.adjustGhost=function(){var e,t,r=this.mouseTrackerService.getMousePosition(),n=this.getValAtMousePosition(r.x),i=this.startingGhostValues.left;n<i?(e=n,t=i):(e=i,t=n);var o={left:this.normalizeGhostValue(e),right:this.normalizeGhostValue(t)};this.setGhostValues({ghostValues:o})},e.prototype.positionGhost=function(){var e=this.mouseTrackerService.getMousePosition(),t=this.getValAtMousePosition(e.x);this.startingGhostValues={left:t,right:this.config.nullEnds?t+this.nullEndWidth:t+this.config.interval},this.setGhostValues({ghostValues:angular.copy(this.startingGhostValues)})},e.prototype.onGhostWrapperMouseDown=function(){this.item.editable&&(this.item.$isGhostOrigin=!0,this.createGhost())},e.prototype.onGhostWrapperMouseMove=function(){this.config.nullEnds?this.positionGhost():this.item.$renderGhost&&this.adjustGhost()},e.prototype.onGhostWrapperMouseUp=function(){var e=this,t=this.getScheduleForAdd(this.ghostValues.left,this.ghostValues.right);this.openEditorForAdd(t).then(function(t){e.$scope.$emit("brWeeklyScheduler.ghostDragEnded",t)}).catch(function(){e.$scope.$emit("brWeeklyScheduler.cancelGhost")})},e.prototype.createGhost=function(){this.item.$renderGhost=!0,this.positionGhost()},e.prototype.commitGhost=function(e){this.item.canAddSchedule()&&(this.item.addScheduleAndMerge(e),this.ngModelCtrl.$setDirty(),this.config.onChange()),this.removeGhost()},e.prototype.getMousePosition=function(e){return e-this.elementOffsetService.left(this.$element)},e.prototype.getValAtMousePosition=function(e){return this.pixelToVal(this.getMousePosition(e))},e.prototype.editSchedule=function(e){var t=this;this.item.canEdit()&&(e.$isEditing=!0,this.config.editSlot(e).then(function(r){var n=t.rangeFactory.createRange(t.config,r);if(t.shouldDelete(n))t.item.removeSchedule(e);else{var i=angular.copy(n);t.item.mergeSchedule(n),angular.equals(i,n)&&e.update(n)}t.ngModelCtrl.$setDirty()}).catch(function(){}).finally(function(){e.$isEditing=!1}))},e.prototype.getSlotLeft=function(e){return this.getUnderlyingInterval(e).offsetLeft+"px"},e.prototype.getSlotRight=function(e,t){this.config.nullEnds&&null===t&&(t=e+this.nullEndWidth),t=this.endAdjusterService.adjustEndForView(this.config,t);var r=this.getUnderlyingInterval(t-this.config.interval),n=r.offsetLeft+r.offsetWidth;return this.element.clientWidth-n+"px"},e.prototype.getUnderlyingInterval=function(e){return e=this.normalizeIntervalValue(e),this.element.parentElement.querySelector("[rel='"+e+"']")},e.prototype.shouldDelete=function(e){return!!e.$isDeleting||!(!this.config.fillEmptyWithDefault||e.value!==this.config.defaultValue)},e.prototype.pixelToVal=function(e){var t=e/this.element.clientWidth;return Math.floor(t*this.config.intervalCount+.5)*this.config.interval},e.prototype.normalizeIntervalValue=function(e){var t=this.config.maxValue-this.config.interval;return this.valueNormalizationService.normalizeValue(e,0,t)},e.prototype.normalizeGhostValue=function(e){return this.valueNormalizationService.normalizeValue(e,0,this.config.maxValue)},e.prototype.removeGhost=function(){this.item.$isGhostOrigin=!1,this.item.$renderGhost=!1,this.setGhostValues(null)},e.$name="brMultiSliderController",e.$controllerAs="multiSliderCtrl",e.$inject=["$element","$q","$scope","brWeeklySchedulerElementOffsetService","brWeeklySchedulerEndAdjusterService","brWeeklySchedulerMouseTrackerService","brWeeklySchedulerNullEndWidth","brWeeklySchedulerRangeFactory","brWeeklySchedulerValueNormalizationService"],e}(),MultiSliderComponent=function(){function e(){this.bindings={config:"<",dragSchedule:"<",ghostValues:"<",item:"=ngModel",setGhostValues:"&"},this.controller=MultiSliderController.$name,this.controllerAs=MultiSliderController.$controllerAs,this.require={ngModelCtrl:"ngModel"},this.templateUrl="ng-weekly-scheduler/multislider/multislider.html"}return e.$name="brMultiSlider",e}();angular.module("br.weeklyScheduler").controller(MultiSliderController.$name,MultiSliderController).component(MultiSliderComponent.$name,new MultiSliderComponent);var NullEndDirective=function(){function e(e){var t=this;this.validator=e,this.link=function(e,r,n,i){i.$validators[t.validator.error]=function(e){return t.validator.validate(e.schedules,e.config)}},this.require="ngModel"}return e.Factory=function(){var t=function(t){return new e(t)};return t.$inject=["brWeeklySchedulerNullEndValidatorService"],t},e.$name="brNullEnd",e}();angular.module("br.weeklyScheduler").directive(NullEndDirective.$name,NullEndDirective.Factory());var OverlapDirective=function(){function e(e){var t=this;this.validator=e,this.link=function(e,r,n,i){i.$validators[t.validator.error]=function(e){return t.validator.validate(e.schedules,e.config)}},this.require="ngModel"}return e.Factory=function(){var t=function(t){return new e(t)};return t.$inject=["brWeeklySchedulerOverlapValidatorService"],t},e.$name="brOverlap",e}();angular.module("br.weeklyScheduler").directive(OverlapDirective.$name,OverlapDirective.Factory());var OverlapService=function(){function e(e){this.endAdjusterService=e}return e.prototype.getOverlapState=function(e,t,r){var n=t.start,i=this.endAdjusterService.adjustEndForView(e,t.end),o=r.start,l=this.endAdjusterService.adjustEndForView(e,r.end);return l>=i&&o<=n?1:i>=l&&n<=o?2:l>n&&l<=i?3:o>=n&&o<i?4:l===n&&l<=i?5:o===i&&o<=i?6:0},e.$name="brWeeklySchedulerOverlapService",e.$inject=["brWeeklySchedulerEndAdjusterService"],e}();angular.module("br.weeklyScheduler").service(OverlapService.$name,OverlapService);var PurgeDefaultService=function(){function e(){}return e.prototype.purge=function(e,t){for(var r=e.length-1;r>=0;r--)e[r].value===t.defaultValue&&e.splice(r,1);return e},e.$name="brWeeklySchedulerPurgeDefaultService",e}();angular.module("br.weeklyScheduler").service(PurgeDefaultService.$name,PurgeDefaultService);var ResizeServiceProvider=function(){function e(){this.customResizeEvents=[],this.serviceInitialized=!1,this.$get.$inject=["$rootScope","$window"]}return e.prototype.setCustomResizeEvents=function(e){this.customResizeEvents=e},e.prototype.$get=function(e,t){var r=this;return{initialize:function(){r.serviceInitialized||(t.addEventListener("resize",function(){e.$apply(function(){e.$broadcast("brWeeklyScheduler.resized")})}),r.customResizeEvents&&r.customResizeEvents.forEach(function(t){e.$on(t,function(){e.$broadcast("brWeeklyScheduler.resized")})}),r.serviceInitialized=!0)}}},e.$name="br.weeklyScheduler.resizeService",e}();angular.module("br.weeklyScheduler").provider(ResizeServiceProvider.$name,ResizeServiceProvider).run([ResizeServiceProvider.$name,function(e){return e.initialize()}]);var RestrictionExplanationsController=function(){function e(e){this.$filter=e,this.explanations={}}return e.prototype.$onInit=function(){var e=this.schedulerCtrl.config;if(e.maxTimeSlot){var t=this.$filter("brWeeklySchedulerSecondsAsText")(e.maxTimeSlot);this.explanations.maxTimeSlot=e.restrictionExplanations.maxTimeSlot(t)}if(e.fullCalendar&&(this.explanations.fullCalendar=e.restrictionExplanations.fullCalendar),e.monoSchedule&&(this.explanations.monoSchedule=e.restrictionExplanations.monoSchedule),e.nullEnds&&(this.explanations.nullEnd=e.restrictionExplanations.nullEnds),e.scheduleCountOptions&&e.scheduleCountOptions.count&&(this.explanations.scheduleCount=e.restrictionExplanations.scheduleCount(e.scheduleCountOptions)),e.minimumSeparation){var r=this.$filter("brWeeklySchedulerSecondsAsText")(e.minimumSeparation);this.explanations.minimumSeparation=e.restrictionExplanations.minimumSeparation(r)}},e.$controllerAs="restrictionExplanationsCtrl",e.$name="brWeeklySchedulerRestrictionExplanationsController",e.$inject=["$filter"],e}(),RestrictionExplanationsComponent=function(){function e(){this.controller=RestrictionExplanationsController.$name,this.controllerAs=RestrictionExplanationsController.$controllerAs,this.require={schedulerCtrl:"^brWeeklyScheduler"},this.template='\n        <div class="srow explanations" ng-class="{ violation: restrictionExplanationsCtrl.schedulerCtrl.formController.$error[key] }" ng-repeat="(key, explanation) in restrictionExplanationsCtrl.explanations">\n            {{ explanation }}\n        </div>\n    '}return e.$name="brRestrictionExplanations",e}();angular.module("br.weeklyScheduler").component(RestrictionExplanationsComponent.$name,new RestrictionExplanationsComponent).controller(RestrictionExplanationsController.$name,RestrictionExplanationsController);var RevalidateDirective=function(){function e(){this.link=function(e,t,r,n){e.$watch(r.ngModel,function(){n.$validate()},!0)},this.require="ngModel"}return e.Factory=function(){return function(){return new e}},e.$name="brRevalidate",e}();angular.module("br.weeklyScheduler").directive(RevalidateDirective.$name,RevalidateDirective.Factory());var ScheduleAreaContainerController=function(){function e(e,t,r,n){this.$element=e,this.$scope=t,this.scrollService=r,this.zoomService=n}return e.prototype.$postLink=function(){var e=this,t=this.$element[0];this.scrollService.hijackScroll(t,20),this.zoomService.resetZoom(t),this.$scope.$on("brWeeklyScheduler.clickOnACell",function(r,n){e.zoomService.zoomInACell(t,r,n)}),this.$scope.$on("brWeeklyScheduler.resetZoom",function(r){e.zoomService.resetZoom(t)}),this.$scope.$on("brWeeklyScheduler.zoomIn",function(r){e.zoomService.zoomIn(t)})},e.$name="brWeeklySchedulerScheduleAreaContainerController",e.$inject=["$element","$scope","brWeeklySchedulerScrollService","brWeeklySchedulerZoomService"],e}(),ScheduleAreaContainerComponent=function(){function e(){this.controller=ScheduleAreaContainerController.$name,this.transclude=!0,this.template="<ng-transclude></ng-transclude>"}return e.$name="brScheduleAreaContainer",e}();angular.module("br.weeklyScheduler").controller(ScheduleAreaContainerController.$name,ScheduleAreaContainerController).component(ScheduleAreaContainerComponent.$name,new ScheduleAreaContainerComponent);var ScheduleCountDirective=function(){function e(e){var t=this;this.validator=e,this.link=function(e,r,n,i){n.brScheduleCount&&(i.$validators[t.validator.error]=function(e){return t.validator.validate(e.schedules,e.config)})},this.require="ngModel"}return e.Factory=function(){var t=function(t){return new e(t)};return t.$inject=["brWeeklySchedulerScheduleCountValidatorService"],t},e.$name="brScheduleCount",e}();angular.module("br.weeklyScheduler").directive(ScheduleCountDirective.$name,ScheduleCountDirective.Factory());var FullCalendarValidatorService=function(){function e(){}return Object.defineProperty(e.prototype,"error",{get:function(){return"fullCalendar"},enumerable:!0,configurable:!0}),e.prototype.validate=function(e,t){if(!t.fullCalendar)return!0;var r=e.length;if(!r)return!1;if(1===r){var n=e[0];return this.validateStartAtMinValue(n.start)&&this.validateEndAtMaxValue(n.end,t)}for(var i=r-1,o=!0,l=(e.sort(function(e,t){return e.start>t.start?1:-1}),0);l<i;l++){var a=e[l],u=e[l+1];if(0===l&&!this.validateStartAtMinValue(a.start))return!1;if(l===i-1&&!this.validateEndAtMaxValue(u.end,t))return!1;o=o&&a.end===u.start}return o},e.prototype.validateStartAtMinValue=function(e){return 0===e},e.prototype.validateEndAtMaxValue=function(e,t){return(e||t.maxValue)===t.maxValue},e.$name="brWeeklySchedulerFullCalendarValidatorService",e}();angular.module("br.weeklyScheduler").service(FullCalendarValidatorService.$name,FullCalendarValidatorService);var MaxTimeSlotValidatorService=function(){function e(e){this.endAdjusterService=e}return Object.defineProperty(e.prototype,"error",{get:function(){return"maxTimeSlot"},enumerable:!0,configurable:!0}),e.prototype.validate=function(e,t){var r=this,n=t.maxTimeSlot;return!n||!e.some(function(e){return e.value!==t.defaultValue&&r.endAdjusterService.adjustEndForView(t,e.end)-e.start>n})},e.$name="brWeeklySchedulerMaxTimeSlotValidatorService",e.$inject=["brWeeklySchedulerEndAdjusterService"],e}();angular.module("br.weeklyScheduler").service(MaxTimeSlotValidatorService.$name,MaxTimeSlotValidatorService);var MinimumSeparationValidatorService=function(){function e(){}return Object.defineProperty(e.prototype,"error",{get:function(){return"minimumSeparation"},enumerable:!0,configurable:!0}),e.prototype.validate=function(e,t){if(!t.minimumSeparation)return!0;var r=e.length;if(r<=1)return!0;var n=r-1;e.sort(function(e,t){return e.start-t.start});for(var i=0;i<n;i++){var o=e[i];if(e[i+1].start-o.end<t.minimumSeparation)return!1}return!0},e.$name="brWeeklySchedulerMinimumSeparationValidatorService",e}();angular.module("br.weeklyScheduler").service(MinimumSeparationValidatorService.$name,MinimumSeparationValidatorService);var MonoScheduleValidatorService=function(){function e(){}return Object.defineProperty(e.prototype,"error",{get:function(){return"monoSchedule"},enumerable:!0,configurable:!0}),e.prototype.validate=function(e,t){return!t.monoSchedule||(!(r=angular.isDefined(t.defaultValue)?e.filter(function(e){return e.value!==t.defaultValue}):e).length||1===r.length);var r},e.$name="brWeeklySchedulerMonoScheduleValidatorService",e}();angular.module("br.weeklyScheduler").service(MonoScheduleValidatorService.$name,MonoScheduleValidatorService);var NullEndScheduleValidatorService=function(){function e(){}return Object.defineProperty(e.prototype,"error",{get:function(){return"nullEnd"},enumerable:!0,configurable:!0}),e.prototype.validate=function(e,t){return t.nullEnds?e.length<=1&&e.every(function(e){return null===e.end}):e.every(function(e){return null!==e.end})},e.$name="brWeeklySchedulerNullEndValidatorService",e}();angular.module("br.weeklyScheduler").service(NullEndScheduleValidatorService.$name,NullEndScheduleValidatorService);var OverlapValidatorService=function(){function e(e){this.overlapService=e}return Object.defineProperty(e.prototype,"error",{get:function(){return"overlap"},enumerable:!0,configurable:!0}),e.prototype.validate=function(e,t){for(var r=e.length,n=!0,i=0;i<r-1;i++){var o=e[i],l=e[i+1];if(!(o.value===l.value)){var a=this.overlapService.getOverlapState(t,o,l);n=n&&[0,6,5].indexOf(a)>-1}}return n},e.$name="brWeeklySchedulerOverlapValidatorService",e.$inject=["brWeeklySchedulerOverlapService"],e}();angular.module("br.weeklyScheduler").service(OverlapValidatorService.$name,OverlapValidatorService);var ScheduleCountValidatorService=function(){function e(){}return Object.defineProperty(e.prototype,"error",{get:function(){return"scheduleCount"},enumerable:!0,configurable:!0}),e.prototype.validate=function(e,t){return!t.scheduleCountOptions.count||(t.scheduleCountOptions.exact?this.validateExactCount(e,t):this.validateMaxCount(e,t))},e.prototype.validateExactCount=function(e,t){return e.length===t.scheduleCountOptions.count},e.prototype.validateMaxCount=function(e,t){return e.length<=t.scheduleCountOptions.count},e.$name="brWeeklySchedulerScheduleCountValidatorService",e}();angular.module("br.weeklyScheduler").service(ScheduleCountValidatorService.$name,ScheduleCountValidatorService);var ScrollService=function(){function e(e){this.zoomService=e}return e.prototype.hijackScroll=function(e,t){var r=this;e.addEventListener("mousewheel",function(n){return n.preventDefault(),n.stopPropagation(),n.ctrlKey?r.zoomService.zoomByScroll(e,n,t):(n.wheelDelta||n.detail)>0?e.scrollLeft-=t:e.scrollLeft+=t,!1})},e.$name="brWeeklySchedulerScrollService",e.$inject=["brWeeklySchedulerZoomService"],e}();angular.module("br.weeklyScheduler").service(ScrollService.$name,ScrollService);var SecondsAsTextFilter=function(){function e(){}return e.Factory=function(){var t=function(t){return function(r){var n="",i=Math.floor(r/t.SECONDS_IN_HOUR);n=e.addHoursToResult(n,i),r-=i*t.SECONDS_IN_HOUR;var o=Math.floor(r/t.SECONDS_IN_MINUTE);return n=e.addMinutesToResult(n,o),r-=o*t.SECONDS_IN_MINUTE,(n=e.addSecondsToResult(n,r))||(n="none"),n}};return t.$inject=["brWeeklySchedulerTimeConstantsService"],t},e.addHoursToResult=function(e,t){return t&&(e+=t+" hours"),e},e.addMinutesToResult=function(e,t){return t&&(e&&(e+=" "),e+=t+" minute"+(t>1?"s":"")),e},e.addSecondsToResult=function(e,t){return t&&(e&&(e+=" "),e+=t+" second"+(t>1?"s":"")),e},e.$name="brWeeklySchedulerSecondsAsText",e}();angular.module("br.weeklyScheduler").filter(SecondsAsTextFilter.$name,SecondsAsTextFilter.Factory());var TimeConstantsService=function(){function e(){}return Object.defineProperty(e.prototype,"SECONDS_IN_DAY",{get:function(){return this.MINUTES_IN_DAY*this.SECONDS_IN_MINUTE},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"SECONDS_IN_HOUR",{get:function(){return this.SECONDS_IN_MINUTE*this.MINUTES_IN_HOUR},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"SECONDS_IN_MINUTE",{get:function(){return 60},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"HOURS_IN_DAY",{get:function(){return 24},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"MINUTES_IN_DAY",{get:function(){return this.MINUTES_IN_HOUR*this.HOURS_IN_DAY},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"MINUTES_IN_HOUR",{get:function(){return 60},enumerable:!0,configurable:!0}),e.$name="brWeeklySchedulerTimeConstantsService",e}();angular.module("br.weeklyScheduler").service(TimeConstantsService.$name,TimeConstantsService);var TimeOfDayFilter=function(){function e(){}return e.Factory=function(){var e=function(e){return function(t){var r=Math.floor(t/e.SECONDS_IN_HOUR),n=r>11&&r<24?"P":"A";t-=r*e.SECONDS_IN_HOUR;var i=Math.floor(t/e.SECONDS_IN_MINUTE);t-=i*e.SECONDS_IN_MINUTE;var o=i.toString();1==o.length&&(o="0"+o);var l=r%12||12;return t?l+":"+o+":"+t+n:l+":"+o+n}};return e.$inject=["brWeeklySchedulerTimeConstantsService"],e},e.$name="brWeeklySchedulerTimeOfDay",e}();angular.module("br.weeklyScheduler").filter(TimeOfDayFilter.$name,TimeOfDayFilter.Factory());var TimeRangeComponent=function(){function e(){this.bindings={schedule:"<"},this.controller=TimeRangeController.$name,this.controllerAs=TimeRangeController.$controllerAs,this.template='\n        <span ng-if="timeRangeCtrl.hasStart && timeRangeCtrl.hasEnd">{{ timeRangeCtrl.schedule.start | brWeeklySchedulerTimeOfDay }}-{{ timeRangeCtrl.schedule.end | brWeeklySchedulerTimeOfDay }}</span>\n        <span ng-if="timeRangeCtrl.hasStart && !timeRangeCtrl.hasEnd">{{ timeRangeCtrl.schedule.start | brWeeklySchedulerTimeOfDay }} until</span>\n    '}return e.$name="brTimeRange",e}(),TimeRangeController=function(){function e(){}return e.prototype.$onInit=function(){this.hasStart=angular.isDefined(this.schedule.start),this.hasEnd=angular.isDefined(this.schedule.end)&&null!==this.schedule.end},e.$controllerAs="timeRangeCtrl",e.$name="brTimeRangeController",e}();angular.module("br.weeklyScheduler").component(TimeRangeComponent.$name,new TimeRangeComponent).controller(TimeRangeController.$name,TimeRangeController);var TouchService=function(){function e(){}return e.prototype.getTouches=function(e){if(e.originalEvent){if(e.originalEvent.touches&&e.originalEvent.touches.length)return e.originalEvent.touches;if(e.originalEvent.changedTouches&&e.originalEvent.changedTouches.length)return e.originalEvent.changedTouches}return e.touches||(e.touches=[e.originalEvent]),e.touches},e.prototype.getPageX=function(e){var t=this.getTouches(e);return t&&t.length&&t[0]?t[0].pageX:null},e.$name="brWeeklySchedulerTouchService",e}();angular.module("br.weeklyScheduler").service(TouchService.$name,TouchService);var ValueNormalizationService=function(){function e(){}return e.prototype.normalizeValue=function(e,t,r){return e<t?t:e>r?r:e},e.$name="brWeeklySchedulerValueNormalizationService",e}();angular.module("br.weeklyScheduler").service(ValueNormalizationService.$name,ValueNormalizationService);var WeeklySchedulerController=function(){function e(e,t,r,n,i,o,l,a){this.$element=e,this.$scope=t,this.$timeout=r,this.adapterService=n,this.configurationService=i,this.conflictingOptionsService=o,this.lastGhostDayService=l,this.missingDaysService=a,this.invalidMessage=""}return e.prototype.$onInit=function(){this.config=this.configurationService.getConfiguration(this.options),this.buildItemsFromAdapter(),this.watchAdapter(),this.watchHoverClass()},e.prototype.$postLink=function(){var e=this;this.$scope.$on("brWeeklyScheduler.slotDragged",function(t,r){e.dragSchedule=r}),this.$scope.$on("brWeeklyScheduler.dragEnded",function(){e.dragSchedule=null}),this.$scope.$on("brWeeklyScheduler.ghostDragEnded",function(t,r){e.$scope.$broadcast("brWeeklyScheduler.commitGhost",r)}),this.$scope.$on("brWeeklyScheduler.removeLastGhost",function(){var t=e.lastGhostDayService.getLastGhostDay(e.items);e.$scope.$broadcast("brWeeklyScheduler.removeGhost",t)}),this.$scope.$on("brWeeklyScheduler.cancelGhost",function(){e.$scope.$broadcast("brWeeklyScheduler.removeAllGhosts")}),this.$timeout(function(){e.invalidMessage=e.getInvalidMessage()})},e.prototype.getInvalidMessage=function(){var e=this.conflictingOptionsService.getConflictingOptions(this.options);return e||(this.hasInvalidSchedule()?"One or more of the schedules is invalid! Please contact service.":void 0)},e.prototype.hasInvalidSchedule=function(){return this.formController.$invalid},e.prototype.buildItems=function(e){this.items=this.missingDaysService.fillItems(this.config,e),this.items.forEach(function(e){return e.mergeOverlaps()}),this.items=this.purgeItems(this.items),this.adapter.items=this.items,this._originalItems=angular.copy(this.items)},e.prototype.buildItemsFromAdapter=function(){var e=this.adapterService.getItemsFromAdapter(this.config,this.adapter);return this.buildItems(e)},e.prototype.purgeItems=function(e){if(this.config.fillEmptyWithDefault)for(var t=0,r=e;t<r.length;t++){r[t].purgeDefaultSchedules()}return e},e.prototype.prepareItems=function(e){if(this.config.fillEmptyWithDefault)for(var t=0,r=e;t<r.length;t++){r[t].fillEmptySlotsWithDefaultSchedules()}return e},e.prototype.setGhostValues=function(e){this.ghostValues=e},e.prototype.resetZoom=function(){this.$scope.$broadcast("brWeeklyScheduler.resetZoom")},e.prototype.zoomIn=function(){this.$scope.$broadcast("brWeeklyScheduler.zoomIn")},e.prototype.rollback=function(){this.buildItems(this._originalItems),this.formController.$setPristine()},e.prototype.save=function(){var e=this;return this.items=this.prepareItems(this.items),this.config.saveScheduler().then(function(){e.items=e.purgeItems(e.items),e.formController.$setPristine()})},e.prototype.watchAdapter=function(){var e=this;this.$scope.$watch(function(){return e.adapter},function(){e.buildItemsFromAdapter()})},e.prototype.watchHoverClass=function(){var e=this;this.$scope.$watch(function(){return e.hoverClass},function(){e.$element.find(".pulse").removeClass("pulse"),e.hoverClass&&e.$element.find("."+e.hoverClass).addClass("pulse")})},e.$controllerAs="schedulerCtrl",e.$name="brWeeklySchedulerController",e.$inject=["$element","$scope","$timeout","brWeeklySchedulerAdapterService","brWeeklySchedulerConfigurationService","brWeeklySchedulerConflictingOptionsService","brWeeklySchedulerLastGhostDayService","brWeeklySchedulerMissingDaysService"],e}(),WeeklySchedulerComponent=function(){function e(){this.bindings={adapter:"<",hoverClass:"<",options:"="},this.controller=WeeklySchedulerController.$name,this.controllerAs=WeeklySchedulerController.$controllerAs,this.require={formController:"form"},this.templateUrl="ng-weekly-scheduler/weekly-scheduler/weekly-scheduler.html"}return e.$name="brWeeklyScheduler",e}();angular.module("br.weeklyScheduler").controller(WeeklySchedulerController.$name,WeeklySchedulerController).component(WeeklySchedulerComponent.$name,new WeeklySchedulerComponent);var _a,DayMap=function(){function e(){}return e.$name="brWeeklySchedulerDayMap",e.value=((_a={})[0]="Mon",_a[1]="Tue",_a[2]="Wed",_a[3]="Thur",_a[4]="Fri",_a[5]="Sat",_a[6]="Sun",_a),e}();angular.module("br.weeklyScheduler").constant(DayMap.$name,DayMap.value);var NullEndWidth=function(){function e(){}return e.$name="brWeeklySchedulerNullEndWidth",e.value=7200,e}();angular.module("br.weeklyScheduler").constant(NullEndWidth.$name,NullEndWidth.value);var WeeklySchedulerItem=function(){function e(e,t,r,n,i,o){this.config=e,this.fillEmptyWithDefaultService=r,this.overlapService=n,this.purgeDefaultService=i,this.rangeFactory=o,this.day=t.day,this.editable=!angular.isDefined(t.editable)||t.editable,this.label=t.label,this.schedules=t.schedules.map(function(t){return o.createRange(e,t)})}return e.prototype.addSchedule=function(e){e.day=this.day;var t=this.rangeFactory.createRange(this.config,e);return this.schedules.push(t),t},e.prototype.addScheduleAndMerge=function(e){var t=this.addSchedule(e);return this.mergeSchedule(t),t},e.prototype.canAddSchedule=function(){return!this.config.nullEnds||this.hasNoSchedules()},e.prototype.canEdit=function(){var e=angular.isFunction(this.config.editSlot);return this.editable&&e},e.prototype.canEditSchedule=function(e){var t=this.editable,r=e.editable;return t&&r},e.prototype.canRenderGhost=function(){return this.config.nullEnds?this.$renderGhost&&this.hasNoSchedules():this.$renderGhost},e.prototype.hasSchedule=function(e){return this.schedules.indexOf(e)>-1},e.prototype.hasNoSchedules=function(){return 0===this.schedules.length},e.prototype.fillEmptySlotsWithDefaultSchedules=function(){this.schedules=this.fillEmptyWithDefaultService.fill(this,this.config)},e.prototype.mergeOverlaps=function(){var e=this;do{this.schedules.forEach(function(t){return e.mergeOverlapsForSchedule(t)})}while(this.needsOverlapsMerged())},e.prototype.mergeSchedule=function(e){this.mergeOverlapsForSchedule(e),this.mergeOverlaps()},e.prototype.purgeDefaultSchedules=function(){this.schedules=this.purgeDefaultService.purge(this.schedules,this.config)},e.prototype.removeSchedule=function(e){var t=this.schedules;t.splice(t.indexOf(e),1),this.config.onRemove()},e.prototype.getOverlapHandler=function(e){var t,r=this;return((t={})[0]=function(e,t){return r.handleNoOverlap(e,t)},t[1]=function(e,t){return r.handleCurrentIsInsideOther(e,t)},t[2]=function(e,t){return r.handleCurrentCoversOther(e,t)},t[3]=function(e,t){return r.handleOtherEndIsInsideCurrent(e,t)},t[4]=function(e,t){return r.handleOtherStartIsInsideCurrent(e,t)},t[5]=function(e,t){return r.handleOtherEndIsCurrentStart(e,t)},t[6]=function(e,t){return r.handleOtherStartIsCurrentEnd(e,t)},t)[e]},e.prototype.handleCurrentCoversOther=function(e,t){this.removeSchedule(t)},e.prototype.handleCurrentIsInsideOther=function(e,t){e.hasSameValueAs(t)?(this.removeSchedule(t),e.update({day:t.day,start:t.start,end:t.end,value:t.value})):this.removeSchedule(e)},e.prototype.handleNoOverlap=function(e,t){},e.prototype.handleOtherEndIsInsideCurrent=function(e,t){e.hasSameValueAs(t)?(this.removeSchedule(t),e.update({day:e.day,start:t.start,end:e.end,value:t.value})):t.update({day:t.day,start:t.start,end:e.start,value:e.value})},e.prototype.handleOtherStartIsInsideCurrent=function(e,t){e.hasSameValueAs(t)?(this.removeSchedule(t),e.update({day:e.day,start:e.start,end:t.end,value:t.value})):t.update({day:t.day,start:e.end,end:t.end,value:t.value})},e.prototype.handleOtherEndIsCurrentStart=function(e,t){e.hasSameValueAs(t)&&this.handleOtherEndIsInsideCurrent(e,t)},e.prototype.handleOtherStartIsCurrentEnd=function(e,t){e.hasSameValueAs(t)&&this.handleOtherStartIsInsideCurrent(e,t)},e.prototype.mergeOverlapsForSchedule=function(e){var t=this;this.schedules.forEach(function(r){if(!r.equals(e)&&(r.editable&&e.editable)){var n=t.overlapService.getOverlapState(t.config,e,r);t.getOverlapHandler(n)(e,r)}})},e.prototype.needsOverlapsMerged=function(){for(var e=this.schedules.length,t=0;t<e-1;t+=1){var r=this.schedules[t],n=this.schedules[t+1];if(!(r.editable&&n.editable))return!1;if(r.hasSameValueAs(n)){var i=this.overlapService.getOverlapState(this.config,r,n);return[5,6].indexOf(i)>-1}}},e}(),WeeklySchedulerItemFactory=function(){function e(e,t,r,n,i){this.dayMap=e,this.fillEmptyWithDefaultService=t,this.overlapService=r,this.purgeDefaultService=n,this.rangeFactory=i}return e.prototype.createItem=function(e,t,r){var n,i=e.createItem(t,r);return n=angular.extend(i,{label:this.dayMap[t]}),new WeeklySchedulerItem(e,n,this.fillEmptyWithDefaultService,this.overlapService,this.purgeDefaultService,this.rangeFactory)},e.$name="brWeeklySchedulerItemFactory",e.$inject=["brWeeklySchedulerDayMap","brWeeklySchedulerFillEmptyWithDefaultService","brWeeklySchedulerOverlapService","brWeeklySchedulerPurgeDefaultService","brWeeklySchedulerRangeFactory"],e}();angular.module("br.weeklyScheduler").service(WeeklySchedulerItemFactory.$name,WeeklySchedulerItemFactory);var WeeklySchedulerRange=function(){function e(e,t,r){this.config=e,this.endAdjusterService=r,this.$class=t.$class,this.$isActive=t.$isActive,this.$isDeleting=t.$isDeleting,this.$isEditing=t.$isEditing,this.day=t.day,this.start=t.start,this.end=t.end,this.value=t.value,this.editable=!angular.isDefined(t.editable)||t.editable}return Object.defineProperty(e.prototype,"duration",{get:function(){return this.end-this.start},enumerable:!0,configurable:!0}),e.prototype.equals=function(e){return angular.equals(this,e)},e.prototype.hasSameValueAs=function(e){return this.value===e.value},e.prototype.update=function(e){var t=this.updateStart(e.start),r=this.updateEnd(e.end);(t||r)&&this.config.onChange()},e.prototype.updateEnd=function(e){return!!this.canUpdateEnd(e)&&(this.end=this.endAdjusterService.adjustEndForModel(this.config,e),!0)},e.prototype.updateStart=function(e){return!!this.canUpdateStart(e)&&(this.start=e,!0)},e.prototype.canUpdateEnd=function(e){var t=this.end!==e,r=e<=this.config.maxValue,n=this.endAdjusterService.adjustEndForView(this.config,e)>=this.start+1;return t&&r&&n},e.prototype.canUpdateStart=function(e){var t=this.start!==e,r=e<=this.endAdjusterService.adjustEndForView(this.config,this.end)-1,n=e>=0;return t&&(this.config.nullEnds||r)&&n},e}(),WeeklySchedulerRangeFactory=function(){function e(e){this.endAdjusterService=e}return e.prototype.createRange=function(e,t){return new WeeklySchedulerRange(e,t,this.endAdjusterService)},e.$name="brWeeklySchedulerRangeFactory",e.$inject=["brWeeklySchedulerEndAdjusterService"],e}();angular.module("br.weeklyScheduler").service(WeeklySchedulerRangeFactory.$name,WeeklySchedulerRangeFactory);var WeeklySlotController=function(){function e(e,t,r,n){this.$element=e,this.$rootScope=t,this.$scope=r,this.dragService=n}return Object.defineProperty(e.prototype,"hasDragSchedule",{get:function(){return angular.isDefined(this.dragSchedule)&&null!=this.dragSchedule},enumerable:!0,configurable:!0}),e.prototype.getDragStartValues=function(){return this.dragService.getDragRangeFromSchedule(this.config,this.schedule)},e.prototype.editSelf=function(){this.editSchedule({schedule:this.schedule})},e.prototype.drag=function(e){var t=this.schedule,r=this.getDelta({pixel:e}),n=Math.round(this.valuesOnDragStart.start+r),i=this.config.nullEnds?null:Math.round(n+this.valuesOnDragStart.duration);this.schedule.update({day:t.day,start:n,end:i,value:t.value})},e.prototype.endDrag=function(){if(this.$rootScope.$broadcast("brWeeklyScheduler.dragEnded"),this.item.hasSchedule(this.schedule)){var e=!this.valuesOnDragStart.equals(this.getDragStartValues());this.schedule.$isActive=!1,e?(this.ngModelCtrl.$setDirty(),this.item.mergeSchedule(this.schedule)):this.editSelf()}},e.prototype.endResize=function(){var e=!this.valuesOnDragStart.equals(this.getDragStartValues());this.schedule.$isActive=!1,e?(this.ngModelCtrl.$setDirty(),this.item.mergeSchedule(this.schedule)):this.editSelf()},e.prototype.resizeStart=function(e){var t=this.getDelta({pixel:e}),r=Math.round(this.valuesOnDragStart.start+t);this.schedule.updateStart(r)&&this.config.onChange()},e.prototype.resizeEnd=function(e){var t=this.getDelta({pixel:e}),r=Math.round(this.valuesOnDragStart.end+t);this.schedule.updateEnd(r)&&this.config.onChange()},e.prototype.startDrag=function(){this.item.canEditSchedule(this.schedule)&&(this.$scope.$emit("brWeeklyScheduler.slotDragged",this.schedule),this.schedule.$isActive=!0,this.valuesOnDragStart=this.getDragStartValues())},e.prototype.startResize=function(){this.item.canEditSchedule(this.schedule)&&(this.schedule.$isActive=!0,this.valuesOnDragStart=this.getDragStartValues())},e.$name="weeklySlotController",e.$controllerAs="weeklySlotCtrl",e.$inject=["$element","$rootScope","$scope","brWeeklySchedulerDragService"],e}(),WeeklySlotComponent=function(){function e(){this.bindings={config:"<",dragSchedule:"<",item:"<",schedule:"=ngModel",editSchedule:"&",getDelta:"&"},this.controller=WeeklySlotController.$name,this.controllerAs=WeeklySlotController.$controllerAs,this.require={ngModelCtrl:"ngModel"},this.templateUrl="ng-weekly-scheduler/weekly-slot/weekly-slot.html"}return e.$name="brWeeklySlot",e}();angular.module("br.weeklyScheduler").controller(WeeklySlotController.$name,WeeklySlotController).component(WeeklySlotComponent.$name,new WeeklySlotComponent);var ZoomService=function(){function e(e){this.$rootScope=e,this.selector=".schedule-area"}return e.prototype.broadcastZoomedInEvent=function(){this.$rootScope.$broadcast("brWeeklyScheduler.zoomedIn")},e.prototype.broadcastZoomedOutEvent=function(){this.$rootScope.$broadcast("brWeeklyScheduler.zoomedOut")},e.prototype.getCurrentZoomWidth=function(e){return parseInt(e.querySelector(this.selector).style.width,10)},e.prototype.getZoomElement=function(e){return e.querySelector(this.selector)},e.prototype.setZoomWidth=function(e,t){this.getZoomElement(e).style.width=t},e.prototype.resetZoom=function(e){this.setZoomWidth(e,"100%"),this.broadcastZoomedOutEvent()},e.prototype.zoomIn=function(e){var t=this.getZoomElement(e).style.width,r=2*parseInt(t,10);this.setZoomWidth(e,r+"%"),this.broadcastZoomedInEvent()},e.prototype.zoomInACell=function(e,t,r){var n=r.nbElements,i=r.idx,o=e.offsetWidth,l=o/5,a=2*l,u=n*l/o*100;this.setZoomWidth(e,u+"%"),e.scrollLeft=i*l-a,this.broadcastZoomedInEvent()},e.prototype.zoomByScroll=function(e,t,r){var n=this.getCurrentZoomWidth(e);if((t.wheelDelta||t.detail)>0)this.setZoomWidth(e,n+2*r+"%"),this.broadcastZoomedInEvent();else{var i=n-2*r;this.setZoomWidth(e,(i>100?i:100)+"%"),this.broadcastZoomedOutEvent()}},e.$name="brWeeklySchedulerZoomService",e.$inject=["$rootScope"],e}();angular.module("br.weeklyScheduler").service(ZoomService.$name,ZoomService),angular.module("ngWeeklySchedulerTemplates",[]).run(["$templateCache",function(e){e.put("index.html",'<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><title>Angularjs weekly scheduler demo</title><link rel="stylesheet" href="testStyles.css"></head><body class="container-fluid" ng-app="demoApp"><div class="row" ng-controller="DemoController as demo" ng-form="testWrapper"><div><code>$scope.model</code><pre ng-bind="model | json" style="max-height: 200px; overflow-y: auto"></pre></div><br-weekly-scheduler adapter="adapter" ng-form="test" options="model.options"></br-weekly-scheduler><code>Valid: {{ test.$valid }}</code><hr><code>Result:<pre ng-bind="result | json" style="overflow-y:auto"></pre></code><script src="testVendorScripts.js"><\/script><script src="testScripts.js"><\/script></div></body></html>'),e.put("ng-weekly-scheduler/multislider/multislider.html",'<div class="ghost-wrapper" br-handle ondragstart="multiSliderCtrl.onGhostWrapperMouseDown()" ondragstop="multiSliderCtrl.onGhostWrapperMouseUp()" ondrag="multiSliderCtrl.onGhostWrapperMouseMove()"><br-ghost-slot class="slot" ng-if="multiSliderCtrl.item.canRenderGhost()" ng-class="{\r\n                      active: multiSliderCtrl.item.$renderGhost,\r\n                      nullEnd: multiSliderCtrl.config.nullEnds\r\n                   }" ng-style="{\r\n                      left: multiSliderCtrl.getSlotLeft(multiSliderCtrl.ghostValues.left),\r\n                      right: multiSliderCtrl.getSlotRight(multiSliderCtrl.ghostValues.left, multiSliderCtrl.ghostValues.right)\r\n                   }"><div class="slotWrapper"><div class="middle fullWidth"><span ng-if="!multiSliderCtrl.config.nullEnds">{{ multiSliderCtrl.ghostValues.left | brWeeklySchedulerTimeOfDay }} - {{ multiSliderCtrl.ghostValues.right | brWeeklySchedulerTimeOfDay }}</span> <span ng-if="multiSliderCtrl.config.nullEnds">{{ multiSliderCtrl.ghostValues.left | brWeeklySchedulerTimeOfDay }} until</span></div></div></br-ghost-slot><br-weekly-slot class="slot {{ schedule.$class }}" config="multiSliderCtrl.config" get-delta="multiSliderCtrl.pixelToVal(pixel)" drag-schedule="multiSliderCtrl.dragSchedule" item="multiSliderCtrl.item" ng-class="{\r\n                    active: schedule.$isActive,\r\n                    disable: !multiSliderCtrl.item.canEditSchedule(schedule),\r\n                    nullEnd: schedule.end === null,\r\n                    pending: schedule.$isEditing\r\n                }" ng-repeat="schedule in multiSliderCtrl.item.schedules" ng-model="schedule" ng-style="{\r\n                    left: multiSliderCtrl.getSlotLeft(schedule.start),\r\n                    right: multiSliderCtrl.getSlotRight(schedule.start, schedule.end)\r\n                }" edit-schedule="multiSliderCtrl.editSchedule(schedule)"></br-weekly-slot></div>'),e.put("ng-weekly-scheduler/weekly-scheduler/weekly-scheduler.html",'<div ng-if="!schedulerCtrl.invalidMessage"><div class="labels"><div class="srow dummy"></div><div class="srow schedule-animate" ng-repeat="item in schedulerCtrl.items track by item.day">{{ item.label }}</div></div><br-schedule-area-container><div class="schedule-area"><div class="srow timestamps"><br-hourly-grid></br-hourly-grid></div><div class="srow calendar schedule-animate" ng-repeat="item in schedulerCtrl.items track by item.day"><br-hourly-grid no-text></br-hourly-grid><br-multi-slider config="schedulerCtrl.config" br-full-calendar="{{ schedulerCtrl.config.fullCalendar }}" br-max-time-slot="{{ schedulerCtrl.config.maxTimeSlot }}" br-minimum-separation="{{ schedulerCtrl.config.minimumSeparation }}" br-mono-schedule="{{ schedulerCtrl.config.monoSchedule }}" br-null-end="{{ schedulerCtrl.config.nullEnds }}" br-schedule-count="{{ schedulerCtrl.config.scheduleCountOptions && schedulerCtrl.config.scheduleCountOptions.count }}" br-overlap br-revalidate drag-schedule="schedulerCtrl.dragSchedule" ghost-values="schedulerCtrl.ghostValues" ng-model="item" ng-model-options="{allowInvalid: true}" set-ghost-values="schedulerCtrl.setGhostValues(ghostValues)"></br-multi-slider></div></div></br-schedule-area-container><br-restriction-explanations></br-restriction-explanations><div class="srow buttons"><button ng-class="schedulerCtrl.config.buttonClasses" type="button" ng-click="schedulerCtrl.rollback()" ng-disabled="!schedulerCtrl.formController.$dirty">Reset</button> <button ng-class="schedulerCtrl.config.buttonClasses" type="button" ng-click="schedulerCtrl.save()" ng-disabled="!schedulerCtrl.formController.$dirty || !schedulerCtrl.formController.$valid" ng-if="schedulerCtrl.config.saveScheduler">Save</button> <button ng-class="schedulerCtrl.config.buttonClasses" type="button" ng-click="schedulerCtrl.resetZoom()">Zoom Out</button> <button ng-class="schedulerCtrl.config.buttonClasses" type="button" ng-click="schedulerCtrl.zoomIn()">Zoom In</button></div></div><div class="srow" ng-if="schedulerCtrl.invalidMessage">{{ schedulerCtrl.invalidMessage }}</div>'),e.put("ng-weekly-scheduler/weekly-slot/weekly-slot.html",'<div class="slotWrapper" title="{{weeklySlotCtrl.schedule.start | brWeeklySchedulerTimeOfDay}} - {{weeklySlotCtrl.schedule.end | brWeeklySchedulerTimeOfDay}}"><div class="handle left" ondrag="weeklySlotCtrl.resizeStart(delta)" ondragstart="weeklySlotCtrl.startResize()" ondragstop="weeklySlotCtrl.endResize()" br-handle ng-if="!weeklySlotCtrl.config.nullEnds"></div><div class="middle" ondrag="weeklySlotCtrl.drag(delta)" ondragstart="weeklySlotCtrl.startDrag()" ondragstop="weeklySlotCtrl.endDrag()" br-handle immediate="weeklySlotCtrl.hasDragSchedule"><br-time-range schedule="weeklySlotCtrl.schedule"></br-time-range></div><div class="handle right" ondrag="weeklySlotCtrl.resizeEnd(delta)" ondragstart="weeklySlotCtrl.startResize()" ondragstop="weeklySlotCtrl.endResize()" br-handle ng-if="!weeklySlotCtrl.config.nullEnds"></div></div>')}]);