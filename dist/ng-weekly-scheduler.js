angular.module('demoApp', ['ngAnimate', 'weeklyScheduler', 'weeklySchedulerI18N'])
    .config(['weeklySchedulerLocaleServiceProvider', function (localeServiceProvider) {
        localeServiceProvider.configure({
            doys: { 'es-es': 4 },
            lang: { 'es-es': { weekNb: 'número de la semana', addNew: 'Añadir' } },
            localeLocationPattern: '/angular-locale_{{locale}}.js'
        });
    }])
    .controller('DemoController', ['$scope', '$timeout', 'weeklySchedulerLocaleService', '$log',
    function ($scope, $timeout, localeService, $log) {
        $scope.model = {
            locale: localeService.$locale.id,
            options: { /*monoSchedule: true*/},
            items: [{
                    label: 'Item 1',
                    editable: false,
                    schedules: [
                        { start: moment('2015-12-27').startOf('day').toDate(), end: moment('2015-12-27').endOf('day').toDate() }
                    ]
                }]
            // {
            //   label: 'Item 2',
            //   schedules: [
            //     { start: moment('2015-12-27').startOf('day').add(5, 'hours').toDate(), end: moment('2015-12-27').endOf('day').add(-5, 'hours').toDate() }
            //   ]
            // }, {
            //   label: 'Item 3',
            //   schedules: [
            //     { start: moment('2015-12-27').startOf('day').add(2, 'hours').toDate(), end: moment('2015-12-27').endOf('day').add(-2, 'hours').toDate() }
            //   ]
            // }]
        };
        this.doSomething = function (itemIndex, scheduleIndex, scheduleValue) {
            $log.debug('The model has changed!', itemIndex, scheduleIndex, scheduleValue);
        };
        this.onLocaleChange = function () {
            $log.debug('The locale is changing to', $scope.model.locale);
            localeService.set($scope.model.locale).then(function ($locale) {
                $log.debug('The locale changed to', $locale.id);
            });
        };
    }]);
angular.module('weeklyScheduler', ['ngWeeklySchedulerTemplates']);
var GRID_TEMPLATE = angular.element('<div class="grid-item"></div>');
var CLICK_ON_A_CELL = 'clickOnACell';
var isCtrl;
function ctrlCheck(e) {
    if (e.which === 17) {
        isCtrl = e.type === 'keydown';
    }
}
function mouseScroll(el, delta) {
    window.addEventListener('keydown', ctrlCheck);
    window.addEventListener('keyup', ctrlCheck);
    el.addEventListener('mousewheel', function (e) {
        e.preventDefault();
        e.stopPropagation();
        if (isCtrl) {
            var style = el.firstChild.style, currentWidth = parseInt(style.width);
            if ((e.wheelDelta || e.detail) > 0) {
                style.width = (currentWidth + 2 * delta) + '%';
            }
            else {
                var width = currentWidth - 2 * delta;
                style.width = (width > 100 ? width : 100) + '%';
            }
        }
        else {
            if ((e.wheelDelta || e.detail) > 0) {
                el.scrollLeft -= delta;
            }
            else {
                el.scrollLeft += delta;
            }
        }
        return false;
    });
}
function zoomInACell(el, event, data) {
    var nbElements = data.nbElements;
    var idx = data.idx;
    // percentWidthFromBeginning is used when the first element of the grid is not full
    // For instance, in the example below `feb 17` is not full
    // feb 17          march 17
    //       |                          |
    var percentWidthFromBeginning = data.percentWidthFromBeginning;
    var containerWidth = el.offsetWidth;
    // leave (1/3) each side
    // 1/3 |    3/3   | 1/3
    var boxWidth = containerWidth / (5 / 3);
    var gutterSize = boxWidth / 3;
    var scheduleAreaWidthPx = nbElements * boxWidth;
    var scheduleAreaWidthPercent = (scheduleAreaWidthPx / containerWidth) * 100;
    el.firstChild.style.width = scheduleAreaWidthPercent + '%';
    if (percentWidthFromBeginning === undefined) {
        // All cells of a line have the same size
        el.scrollLeft = idx * boxWidth - gutterSize;
    }
    else {
        // Sizes of cells in a line could different (especially the first one)
        el.scrollLeft = scheduleAreaWidthPx * (percentWidthFromBeginning / 100) - gutterSize;
    }
}
var HandleDirective = /** @class */ (function () {
    function HandleDirective($document) {
        var _this = this;
        this.$document = $document;
        this.restrict = 'A';
        this.scope = {
            ondrag: '=',
            ondragstop: '=',
            ondragstart: '='
        };
        this.link = function (scope, element) {
            var $document = _this.$document;
            var x = 0;
            element.on('mousedown', function (event) {
                // Prevent default dragging of selected content
                event.preventDefault();
                x = event.pageX;
                $document.on('mousemove', mousemove);
                $document.on('mouseup', mouseup);
                if (scope.ondragstart) {
                    scope.ondragstart();
                }
            });
            function mousemove(event) {
                var delta = event.pageX - x;
                if (scope.ondrag) {
                    scope.ondrag(delta);
                }
            }
            function mouseup() {
                $document.unbind('mousemove', mousemove);
                $document.unbind('mouseup', mouseup);
                if (scope.ondragstop) {
                    scope.ondragstop();
                }
            }
        };
    }
    HandleDirective.Factory = function () {
        var directive = function ($document) { return new HandleDirective($document); };
        directive.$inject = ['$document'];
        return directive;
    };
    HandleDirective.$name = 'handle';
    return HandleDirective;
}());
angular.module('weeklyScheduler')
    .directive(HandleDirective.$name, HandleDirective.Factory());
var HourlyGridDirective = /** @class */ (function () {
    function HourlyGridDirective() {
        var _this = this;
        this.restrict = 'E';
        this.require = '^weeklyScheduler';
        this.link = function (scope, element, attrs, schedulerCtrl) {
            if (schedulerCtrl.config) {
                _this.doGrid(scope, element, attrs, schedulerCtrl.config);
            }
            schedulerCtrl.$modelChangeListeners.push(function (newModel) {
                _this.doGrid(scope, element, attrs, newModel);
            });
        };
    }
    HourlyGridDirective.prototype.handleClickEvent = function (child, nbHours, idx, scope) {
        child.bind('click', function () {
            scope.$broadcast(CLICK_ON_A_CELL, {
                nbElements: nbHours,
                idx: idx
            });
        });
    };
    HourlyGridDirective.prototype.doGrid = function (scope, element, attrs, model) {
        var i;
        // Calculate hour width distribution
        var tickcount = model.nbHours;
        var ticksize = 100 / tickcount;
        var gridItemEl = GRID_TEMPLATE.css({ width: ticksize + '%' });
        // Clean element
        element.empty();
        for (i = 0; i < tickcount; i++) {
            var child = gridItemEl.clone();
            if (angular.isUndefined(attrs.noText)) {
                this.handleClickEvent(child, tickcount, i, scope);
                var currentHour = i % 12;
                var meridiem = i >= 12 ? 'pm' : 'am';
                child.text("" + (currentHour || '12') + meridiem);
            }
            element.append(child);
        }
    };
    HourlyGridDirective.Factory = function () {
        var directive = function () { return new HourlyGridDirective(); };
        return directive;
    };
    HourlyGridDirective.$name = 'hourlyGrid';
    return HourlyGridDirective;
}());
angular
    .module('weeklyScheduler')
    .directive(HourlyGridDirective.$name, HourlyGridDirective.Factory());
var InjectDirective = /** @class */ (function () {
    function InjectDirective() {
        this.link = function ($scope, $element, $attrs, controller, $transclude) {
            if (!$transclude) {
                throw 'Illegal use of ngTransclude directive in the template! No parent directive that requires a transclusion found.';
            }
            var innerScope = $scope.$new();
            $transclude(innerScope, function (clone) {
                $element.empty();
                $element.append(clone);
                $element.on('$destroy', function () {
                    innerScope.$destroy();
                });
            });
        };
    }
    InjectDirective.Factory = function () {
        var directive = function () { return new InjectDirective(); };
        return directive;
    };
    InjectDirective.$name = 'inject';
    return InjectDirective;
}());
angular
    .module('weeklyScheduler')
    .directive(InjectDirective.$name, InjectDirective.Factory());
angular.module('weeklySchedulerI18N', ['tmh.dynamicLocale']);
angular.module('weeklySchedulerI18N')
    .provider('weeklySchedulerLocaleService', ['tmhDynamicLocaleProvider', function (tmhDynamicLocaleProvider) {
        var defaultConfig = {
            doys: { 'de-de': 4, 'en-gb': 4, 'en-us': 6, 'fr-fr': 4 },
            lang: {
                'de-de': { weekNb: 'Wochenummer', addNew: 'Hinzufügen' },
                'en-gb': { weekNb: 'Week #', addNew: 'Add' },
                'en-us': { weekNb: 'Week #', addNew: 'Add' },
                'fr-fr': { weekNb: 'N° de semaine', addNew: 'Ajouter' }
            }
        };
        this.configure = function (config) {
            if (config && angular.isObject(config)) {
                angular.merge(defaultConfig, config);
                if (defaultConfig.localeLocationPattern) {
                    tmhDynamicLocaleProvider.localeLocationPattern(defaultConfig.localeLocationPattern);
                }
            }
        };
        this.$get = ['$rootScope', '$locale', 'tmhDynamicLocale', function ($rootScope, $locale, tmhDynamicLocale) {
                var momentLocaleCache = {};
                function getLang() {
                    var key = $locale.id;
                    if (!momentLocaleCache[key]) {
                        momentLocaleCache[key] = getMomentLocale(key);
                        moment.locale(momentLocaleCache[key].id, momentLocaleCache[key].locale);
                    }
                    else {
                        moment.locale(momentLocaleCache[key].id);
                    }
                    return defaultConfig.lang[key];
                }
                // We just need few moment local information
                function getMomentLocale(key) {
                    return {
                        id: key,
                        locale: {
                            week: {
                                // Angular monday = 0 whereas Moment monday = 1
                                dow: ($locale.DATETIME_FORMATS.FIRSTDAYOFWEEK + 1) % 7,
                                doy: defaultConfig.doys[key]
                            }
                        }
                    };
                }
                $rootScope.$on('$localeChangeSuccess', function () {
                    $rootScope.$broadcast('weeklySchedulerLocaleChanged', getLang());
                });
                return {
                    $locale: $locale,
                    getLang: getLang,
                    set: function (key) {
                        return tmhDynamicLocale.set(key);
                    }
                };
            }];
    }]);
var MultiSliderDirective = /** @class */ (function () {
    function MultiSliderDirective(timeService) {
        var _this = this;
        this.timeService = timeService;
        this.restrict = 'E';
        this.require = '^weeklyScheduler';
        this.templateUrl = 'ng-weekly-scheduler/multislider/multislider.html';
        this.link = function (scope, element, attrs, schedulerCtrl) {
            var conf = schedulerCtrl.config;
            // The default scheduler block size when adding a new item
            var defaultNewScheduleSize = parseInt(attrs.size) || 8;
            var valToPixel = function (val) {
                var percent = val / (conf.nbHours);
                return Math.floor(percent * element[0].clientWidth + 0.5);
            };
            var pixelToVal = function (pixel) {
                var percent = pixel / element[0].clientWidth;
                return Math.floor(percent * (conf.nbHours) + 0.5);
            };
            var addSlot = function (start, end) {
                start = start >= 0 ? start : 0;
                end = end <= conf.nbHours ? end : conf.nbHours;
                var startDate = _this.timeService.addHour(conf.minDate, start);
                var endDate = _this.timeService.addHour(conf.minDate, end);
                scope.$apply(function () {
                    var item = scope.item;
                    if (!item.schedules) {
                        item.schedules = [];
                    }
                    item.schedules.push({ start: startDate.toDate(), end: endDate.toDate() });
                });
            };
            var hoverElement = angular.element(element.find('div')[0]);
            var hoverElementWidth = valToPixel(defaultNewScheduleSize);
            hoverElement.css({
                width: hoverElementWidth + 'px'
            });
            element.on('mousemove', function (e) {
                var elOffX = element[0].getBoundingClientRect().left;
                hoverElement.css({
                    left: e.pageX - elOffX - hoverElementWidth / 2 + 'px'
                });
            });
            hoverElement.on('click', function (event) {
                if (!element.attr('no-add')) {
                    var elOffX = element[0].getBoundingClientRect().left;
                    var pixelOnClick = event.pageX - elOffX;
                    var valOnClick = pixelToVal(pixelOnClick);
                    var start = Math.round(valOnClick - defaultNewScheduleSize / 2);
                    var end = start + defaultNewScheduleSize;
                    addSlot(start, end);
                }
            });
        };
    }
    MultiSliderDirective.Factory = function () {
        var directive = function (timeService) { return new MultiSliderDirective(timeService); };
        directive.$inject = [
            'weeklySchedulerTimeService'
        ];
        return directive;
    };
    MultiSliderDirective.$name = 'multiSlider';
    return MultiSliderDirective;
}());
angular.module('weeklyScheduler')
    .directive(MultiSliderDirective.$name, MultiSliderDirective.Factory());
var WeeklySchedulerTimeService = /** @class */ (function () {
    function WeeklySchedulerTimeService() {
        this.WEEK = 'week';
        this.HOUR = 'hour';
    }
    WeeklySchedulerTimeService.prototype.addHour = function (moment, nbHour) {
        return moment.clone().add(nbHour, 'hour');
    };
    WeeklySchedulerTimeService.prototype.compare = function (date, method, lastMin) {
        if (date) {
            var dateAsMoment;
            if (angular.isDate(date)) {
                dateAsMoment = moment(date);
            }
            else if (date._isAMomentObject) {
                dateAsMoment = date;
            }
            else {
                throw 'Could not parse date [' + date + ']';
            }
            return dateAsMoment[method](lastMin) ? dateAsMoment : lastMin;
        }
    };
    WeeklySchedulerTimeService.prototype.hourPreciseDiff = function (start, end) {
        return end.clone().diff(start.clone(), this.HOUR, true);
    };
    WeeklySchedulerTimeService.$name = 'weeklySchedulerTimeService';
    return WeeklySchedulerTimeService;
}());
angular.module('weeklyScheduler')
    .service(WeeklySchedulerTimeService.$name, WeeklySchedulerTimeService);
var WeeklySchedulerController = /** @class */ (function () {
    function WeeklySchedulerController($injector, $log) {
        this.$injector = $injector;
        this.$log = $log;
        this.defaultOptions = {
            monoSchedule: false,
            selector: '.schedule-area-container'
        };
    }
    WeeklySchedulerController.prototype.$onInit = function () {
        // Try to get the i18n service
        var name = 'weeklySchedulerLocaleService';
        if (this.$injector.has(name)) {
            this.$log.info('The I18N service has successfully been initialized!');
            var localeService = this.$injector.get(name); /* TODO type */
            this.defaultOptions.labels = localeService.getLang();
        }
        else {
            this.$log.info('No I18N found for this module, check the ng module [weeklySchedulerI18N] if you need i18n.');
        }
        // Will hang our model change listeners
        this.$modelChangeListeners = [];
    };
    WeeklySchedulerController.$controllerAs = 'schedulerCtrl';
    WeeklySchedulerController.$name = 'weeklySchedulerController';
    WeeklySchedulerController.$inject = [
        '$injector',
        '$log'
    ];
    return WeeklySchedulerController;
}());
var WeeklySchedulerDirective = /** @class */ (function () {
    function WeeklySchedulerDirective($log, $parse, timeService) {
        var _this = this;
        this.$log = $log;
        this.$parse = $parse;
        this.timeService = timeService;
        this.restrict = 'E';
        this.require = 'weeklyScheduler';
        this.transclude = true;
        this.templateUrl = 'ng-weekly-scheduler/weekly-scheduler/weekly-scheduler.html';
        this.controller = WeeklySchedulerController.$name;
        this.controllerAs = WeeklySchedulerController.$controllerAs;
        this.link = function (scope, element, attrs, schedulerCtrl) {
            var optionsFn = _this.$parse(attrs.options), options = angular.extend(schedulerCtrl.defaultOptions, optionsFn(scope) || {});
            // Get the schedule container element
            var el = element[0].querySelector(schedulerCtrl.defaultOptions.selector);
            var self = _this;
            function onModelChange(items) {
                // Check items are present
                if (items) {
                    // Check items are in an Array
                    if (!angular.isArray(items)) {
                        throw 'You should use weekly-scheduler directive with an Array of items';
                    }
                    // Keep track of our model (use it in template)
                    schedulerCtrl.items = items;
                    // First calculate configuration
                    schedulerCtrl.config = self.config(items.reduce(function (result, item) {
                        var schedules = item.schedules;
                        return result.concat(schedules && schedules.length ?
                            // If in multiSlider mode, ensure a schedule array is present on each item
                            // Else only use first element of schedule array
                            (options.monoSchedule ? item.schedules = [schedules[0]] : schedules) :
                            item.schedules = []);
                    }, []), options);
                    // Finally, run the sub directives listeners
                    schedulerCtrl.$modelChangeListeners.forEach(function (listener) {
                        listener(schedulerCtrl.config);
                    });
                }
            }
            if (el) {
                // Install mouse scrolling event listener for H scrolling
                mouseScroll(el, 20);
                scope.$on(CLICK_ON_A_CELL, function (e, data) {
                    zoomInACell(el, e, data);
                });
                schedulerCtrl.on = {
                    change: function (itemIndex, scheduleIndex, scheduleValue) {
                        var onChangeFunction = _this.$parse(attrs.onChange)(scope);
                        if (angular.isFunction(onChangeFunction)) {
                            return onChangeFunction(itemIndex, scheduleIndex, scheduleValue);
                        }
                    }
                };
                /**
                 * Watch the model items
                 */
                scope.$watchCollection(attrs.items, onModelChange);
                /**
                 * Listen to $locale change (brought by external module weeklySchedulerI18N)
                 */
                scope.$on('weeklySchedulerLocaleChanged', function (e, labels) {
                    if (schedulerCtrl.config) {
                        schedulerCtrl.config.labels = labels;
                    }
                    onModelChange(angular.copy(this.$parse(attrs.items)(scope), []));
                });
            }
        };
    }
    /**
     * Configure the scheduler.
     * @param schedules
     * @param options
     * @returns {{minDate: *, nbHours: *}}
     */
    WeeklySchedulerDirective.prototype.config = function (schedules, options) {
        var _this = this;
        var now = moment();
        // Calculate min date of all scheduled events
        var minDate = (schedules ? schedules.reduce(function (minDate, slot) {
            return _this.timeService.compare(slot.start, 'isBefore', minDate);
        }, now) : now).startOf('week');
        var result = angular.extend(options, { minDate: minDate, nbHours: 24 });
        // Log configuration
        this.$log.debug('Weekly Scheduler configuration:', result);
        return result;
    };
    WeeklySchedulerDirective.Factory = function () {
        var directive = function ($log, $parse, timeService) { return new WeeklySchedulerDirective($log, $parse, timeService); };
        directive.$inject = [
            '$log',
            '$parse',
            'weeklySchedulerTimeService'
        ];
        return directive;
    };
    WeeklySchedulerDirective.$name = 'weeklyScheduler';
    return WeeklySchedulerDirective;
}());
/* global mouseScroll, CLICK_ON_A_CELL, zoomInACell */
angular.module('weeklyScheduler')
    .controller(WeeklySchedulerController.$name, WeeklySchedulerController)
    .directive(WeeklySchedulerDirective.$name, WeeklySchedulerDirective.Factory());
var WeeklySlotDirective = /** @class */ (function () {
    function WeeklySlotDirective(timeService) {
        var _this = this;
        this.timeService = timeService;
        this.restrict = 'E';
        this.require = ['^weeklyScheduler', 'ngModel'];
        this.templateUrl = 'ng-weekly-scheduler/weekly-slot/weekly-slot.html';
        this.link = function (scope, element, attrs, ctrls) {
            var schedulerCtrl = ctrls[0], ngModelCtrl = ctrls[1];
            var conf = schedulerCtrl.config;
            var index = scope.$parent.$index;
            var containerEl = element.parent();
            var resizeDirectionIsStart = true;
            var valuesOnDragStart = { start: scope.schedule.start, end: scope.schedule.end };
            var pixelToVal = function (pixel) {
                var percent = pixel / containerEl[0].clientWidth;
                return Math.floor(percent * conf.nbHours + 0.5);
            };
            var mergeOverlaps = function () {
                var schedule = scope.schedule;
                var schedules = scope.item.schedules;
                schedules.forEach(function (el) {
                    if (el !== schedule) {
                        // model is inside another slot
                        if (el.end >= schedule.end && el.start <= schedule.start) {
                            schedules.splice(schedules.indexOf(el), 1);
                            schedule.end = el.end;
                            schedule.start = el.start;
                        }
                        // model completely covers another slot
                        else if (schedule.end >= el.end && schedule.start <= el.start) {
                            schedules.splice(schedules.indexOf(el), 1);
                        }
                        // another slot's end is inside current model
                        else if (el.end >= schedule.start && el.end <= schedule.end) {
                            schedules.splice(schedules.indexOf(el), 1);
                            schedule.start = el.start;
                        }
                        // another slot's start is inside current model
                        else if (el.start >= schedule.start && el.start <= schedule.end) {
                            schedules.splice(schedules.indexOf(el), 1);
                            schedule.end = el.end;
                        }
                    }
                });
            };
            /**
             * Delete on right click on slot
             */
            var deleteSelf = function () {
                containerEl.removeClass('dragging');
                containerEl.removeClass('slot-hover');
                scope.item.schedules.splice(scope.item.schedules.indexOf(scope.schedule), 1);
                containerEl.find('weekly-slot').remove();
                scope.$apply();
            };
            element.find('span').on('click', function (e) {
                e.preventDefault();
                deleteSelf();
            });
            element.on('mouseover', function () {
                containerEl.addClass('slot-hover');
            });
            element.on('mouseleave', function () {
                containerEl.removeClass('slot-hover');
            });
            if (scope.item.editable !== false) {
                scope.startResizeStart = function () {
                    resizeDirectionIsStart = true;
                    scope.startDrag();
                };
                scope.startResizeEnd = function () {
                    resizeDirectionIsStart = false;
                    scope.startDrag();
                };
                scope.startDrag = function () {
                    element.addClass('active');
                    containerEl.addClass('dragging');
                    containerEl.attr('no-add', 'true');
                    valuesOnDragStart = { start: ngModelCtrl.$viewValue.start, end: ngModelCtrl.$viewValue.end };
                };
                scope.endDrag = function () {
                    // this prevents user from accidentally
                    // adding new slot after resizing or dragging
                    setTimeout(function () {
                        containerEl.removeAttr('no-add');
                    }, 500);
                    element.removeClass('active');
                    containerEl.removeClass('dragging');
                    mergeOverlaps();
                    scope.$apply();
                };
                scope.resize = function (d) {
                    var ui = ngModelCtrl.$viewValue;
                    var delta = pixelToVal(d);
                    if (resizeDirectionIsStart) {
                        var newStart = Math.round(valuesOnDragStart.start + delta);
                        if (ui.start !== newStart && newStart <= ui.end - 1 && newStart >= 0) {
                            ngModelCtrl.$setViewValue({
                                start: newStart,
                                end: ui.end
                            });
                            ngModelCtrl.$render();
                        }
                    }
                    else {
                        var newEnd = Math.round(valuesOnDragStart.end + delta);
                        if (ui.end !== newEnd && newEnd >= ui.start + 1 && newEnd <= conf.nbHours) {
                            ngModelCtrl.$setViewValue({
                                start: ui.start,
                                end: newEnd
                            });
                            ngModelCtrl.$render();
                        }
                    }
                };
                scope.drag = function (d) {
                    var ui = ngModelCtrl.$viewValue;
                    var delta = pixelToVal(d);
                    var duration = valuesOnDragStart.end - valuesOnDragStart.start;
                    var newStart = Math.round(valuesOnDragStart.start + delta);
                    var newEnd = Math.round(newStart + duration);
                    if (ui.start !== newStart && newStart >= 0 && newEnd <= conf.nbHours) {
                        ngModelCtrl.$setViewValue({
                            start: newStart,
                            end: newEnd
                        });
                        ngModelCtrl.$render();
                    }
                };
            }
            // on init, merge overlaps
            mergeOverlaps();
            //// UI -> model ////////////////////////////////////
            ngModelCtrl.$parsers.push(function (ui) {
                ngModelCtrl.$modelValue.start = _this.timeService.addHour(conf.minDate, ui.start).toDate();
                ngModelCtrl.$modelValue.end = _this.timeService.addHour(conf.minDate, ui.end).toDate();
                //$log.debug('PARSER :', ngModelCtrl.$modelValue.$$hashKey, index, scope.$index, ngModelCtrl.$modelValue);
                schedulerCtrl.on.change(index, scope.$index, ngModelCtrl.$modelValue);
                return ngModelCtrl.$modelValue;
            });
            //// model -> UI ////////////////////////////////////
            ngModelCtrl.$formatters.push(function (model) {
                var ui = {
                    start: _this.timeService.hourPreciseDiff(conf.minDate, moment(model.start)),
                    end: _this.timeService.hourPreciseDiff(conf.minDate, moment(model.end))
                };
                //$log.debug('FORMATTER :', index, scope.$index, ui);
                return ui;
            });
            ngModelCtrl.$render = function () {
                var ui = ngModelCtrl.$viewValue;
                var css = {
                    left: ui.start / conf.nbHours * 100 + '%',
                    width: (ui.end - ui.start) / conf.nbHours * 100 + '%'
                };
                //$log.debug('RENDER :', index, scope.$index, css);
                element.css(css);
            };
            scope.$on('weeklySchedulerLocaleChanged', function () {
                // Simple change object reference so that ngModel triggers formatting & rendering
                scope.schedule = angular.copy(scope.schedule);
            });
        };
    }
    WeeklySlotDirective.Factory = function () {
        var directive = function (timeService) { return new WeeklySlotDirective(timeService); };
        directive.$inject = ['weeklySchedulerTimeService'];
        return directive;
    };
    WeeklySlotDirective.$name = 'weeklySlot';
    return WeeklySlotDirective;
}());
angular
    .module('weeklyScheduler')
    .directive(WeeklySlotDirective.$name, WeeklySlotDirective.Factory());

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC9kZW1vLWFwcC50cyIsImFwcC9uZy13ZWVrbHktc2NoZWR1bGVyL21vZHVsZS50cyIsImFwcC9uZy13ZWVrbHktc2NoZWR1bGVyL2hhbmRsZS9oYW5kbGUudHMiLCJhcHAvbmctd2Vla2x5LXNjaGVkdWxlci9ob3VybHktZ3JpZC9ob3VybHktZ3JpZC50cyIsImFwcC9uZy13ZWVrbHktc2NoZWR1bGVyL2luamVjdC9pbmplY3QudHMiLCJhcHAvbmctd2Vla2x5LXNjaGVkdWxlci9sb2NhbGUvbG9jYWxlLXNlcnZpY2UudHMiLCJhcHAvbmctd2Vla2x5LXNjaGVkdWxlci9tdWx0aXNsaWRlci9tdWx0aXNsaWRlci50cyIsImFwcC9uZy13ZWVrbHktc2NoZWR1bGVyL3RpbWUvdGltZS1zZXJ2aWNlcy50cyIsImFwcC9uZy13ZWVrbHktc2NoZWR1bGVyL3dlZWtseS1zY2hlZHVsZXIvd2Vla2x5LXNjaGVkdWxlci50cyIsImFwcC9uZy13ZWVrbHktc2NoZWR1bGVyL3dlZWtseS1zbG90L3dlZWtseS1zbG90LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUVBLE9BQU8sQ0FBQyxNQUFNLENBQUMsU0FBUyxFQUFFLENBQUMsV0FBVyxFQUFFLGlCQUFpQixFQUFFLHFCQUFxQixDQUFDLENBQUM7S0FFL0UsTUFBTSxDQUFDLENBQUMsc0NBQXNDLEVBQUUsVUFBVSxxQkFBcUI7UUFDOUUscUJBQXFCLENBQUMsU0FBUyxDQUFDO1lBQzlCLElBQUksRUFBRSxFQUFFLE9BQU8sRUFBRSxDQUFDLEVBQUU7WUFDcEIsSUFBSSxFQUFFLEVBQUUsT0FBTyxFQUFFLEVBQUUsTUFBTSxFQUFFLHFCQUFxQixFQUFFLE1BQU0sRUFBRSxRQUFRLEVBQUUsRUFBRTtZQUN0RSxxQkFBcUIsRUFBRSwrQkFBK0I7U0FDdkQsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7S0FFRixVQUFVLENBQUMsZ0JBQWdCLEVBQUUsQ0FBQyxRQUFRLEVBQUUsVUFBVSxFQUFFLDhC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RyxDQUFDLEdBQUcsQ0FBQyxDQUFDO1lBQ25CLENBQUMsQ0FBQztZQUVGLEtBQUssQ0FBQyxHQUFHLENBQUMsOEJBQThCLEVBQUU7Z0JBQ3hDLGlGQUFpRjtnQkFDakYsS0FBSyxDQUFDLFFBQVEsR0FBRyxPQUFPLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxRQUFRLENBQUMsQ0FBQztZQUNoRCxDQUFDLENBQUMsQ0FBQztRQUNMLENBQUMsQ0FBQTtJQWhNRCxDQUFDO0lBa01NLDJCQUFPLEdBQWQ7UUFDRSxJQUFJLFNBQVMsR0FBRyxVQUFDLFdBQVcsSUFBSyxPQUFBLElBQUksbUJBQW1CLENBQUMsV0FBVyxDQUFDLEVBQXBDLENBQW9DLENBQUM7UUFFdEUsU0FBUyxDQUFDLE9BQU8sR0FBRyxDQUFDLDRCQUE0QixDQUFDLENBQUM7UUFFbkQsT0FBTyxTQUFTLENBQUM7SUFDbkIsQ0FBQztJQTdNTSx5QkFBSyxHQUFHLFlBQVksQ0FBQztJQThNOUIsMEJBQUM7Q0EvTUQsQUErTUMsSUFBQTtBQUVELE9BQU87S0FDSixNQUFNLENBQUMsaUJBQWlCLENBQUM7S0FDekIsU0FBUyxDQUFDLG1CQUFtQixDQUFDLEtBQUssRUFBRSxtQkFBbUIsQ0FBQyxPQUFPLEVBQUUsQ0FBQyxDQUFDIiwiZmlsZSI6Im5nLXdlZWtseS1zY2hlZHVsZXIuanMiLCJzb3VyY2VzQ29udGVudCI6WyJkZWNsYXJlIHZhciBtb21lbnQ7XHJcblxyXG5hbmd1bGFyLm1vZHVsZSgnZGVtb0FwcCcsIFsnbmdBbmltYXRlJywgJ3dlZWtseVNjaGVkdWxlcicsICd3ZWVrbHlTY2hlZHVsZXJJMThOJ10pXHJcblxyXG4gIC5jb25maWcoWyd3ZWVrbHlTY2hlZHVsZXJMb2NhbGVTZXJ2aWNlUHJvdmlkZXInLCBmdW5jdGlvbiAobG9jYWxlU2VydmljZVByb3ZpZGVyKSB7XHJcbiAgICBsb2NhbGVTZXJ2aWNlUHJvdmlkZXIuY29uZmlndXJlKHtcclxuICAgICAgZG95czogeyAnZXMtZXMnOiA0IH0sXHJcbiAgICAgIGxhbmc6IHsgJ2VzLWVzJzogeyB3ZWVrTmI6ICduw7ptZXJvIGRlIGxhIHNlbWFuYScsIGFkZE5ldzogJ0HDsWFkaXInIH0gfSxcclxuICAgICAgbG9jYWxlTG9jYXRpb25QYXR0ZXJuOiAnL2FuZ3VsYXItbG9jYWxlX3t7bG9jYWxlfX0uanMnXHJcbiAgICB9KTtcclxuICB9XSlcclxuXHJcbiAgLmNvbnRyb2xsZXIoJ0RlbW9Db250cm9sbGVyJywgWyckc2NvcGUnLCAnJHRpbWVvdXQnLCAnd2Vla2x5U2NoZWR1bGVyTG9jYWxlU2VydmljZScsICckbG9nJyxcclxuICAgIGZ1bmN0aW9uICgkc2NvcGUsICR0aW1lb3V0LCBsb2NhbGVTZXJ2aWNlLCAkbG9nKSB7XHJcblxyXG4gICAgICAkc2NvcGUubW9kZWwgPSB7XHJcbiAgICAgICAgbG9jYWxlOiBsb2NhbGVTZXJ2aWNlLiRsb2NhbGUuaWQsXHJcbiAgICAgICAgb3B0aW9uczogey8qbW9ub1NjaGVkdWxlOiB0cnVlKi8gfSxcclxuICAgICAgICBpdGVtczogW3tcclxuICAgICAgICAgIGxhYmVsOiAnSXRlbSAxJyxcclxuICAgICAgICAgIGVkaXRhYmxlOiBmYWxzZSxcclxuICAgICAgICAgIHNjaGVkdWxlczogW1xyXG4gICAgICAgICAgICB7IHN0YXJ0OiBtb21lbnQoJzIwMTUtMTItMjcnKS5zdGFydE9mKCdkYXknKS50b0RhdGUoKSwgZW5kOiBtb21lbnQoJzIwMTUtMTItMjcnKS5lbmRPZignZGF5JykudG9EYXRlKCkgfVxyXG4gICAgICAgICAgXVxyXG4gICAgICAgIH1dXHJcbiAgICAgICAgLy8ge1xyXG4gICAgICAgIC8vICAgbGFiZWw6ICdJdGVtIDInLFxyXG4gICAgICAgIC8vICAgc2NoZWR1bGVzOiBbXHJcbiAgICAgICAgLy8gICAgIHsgc3RhcnQ6IG1vbWVudCgnMjAxNS0xMi0yNycpLnN0YXJ0T2YoJ2RheScpLmFkZCg1LCAnaG91cnMnKS50b0RhdGUoKSwgZW5kOiBtb21lbnQoJzIwMTUtMTItMjcnKS5lbmRPZignZGF5JykuYWRkKC01LCAnaG91cnMnKS50b0RhdGUoKSB9XHJcbiAgICAgICAgLy8gICBdXHJcbiAgICAgICAgLy8gfSwge1xyXG4gICAgICAgIC8vICAgbGFiZWw6ICdJdGVtIDMnLFxyXG4gICAgICAgIC8vICAgc2NoZWR1bGVzOiBbXHJcbiAgICAgICAgLy8gICAgIHsgc3RhcnQ6IG1vbWVudCgnMjAxNS0xMi0yNycpLnN0YXJ0T2YoJ2RheScpLmFkZCgyLCAnaG91cnMnKS50b0RhdGUoKSwgZW5kOiBtb21lbnQoJzIwMTUtMTItMjcnKS5lbmRPZignZGF5JykuYWRkKC0yLCAnaG91cnMnKS50b0RhdGUoKSB9XHJcbiAgICAgICAgLy8gICBdXHJcbiAgICAgICAgLy8gfV1cclxuICAgICAgfTtcclxuXHJcbiAgICAgIHRoaXMuZG9Tb21ldGhpbmcgPSBmdW5jdGlvbiAoaXRlbUluZGV4LCBzY2hlZHVsZUluZGV4LCBzY2hlZHVsZVZhbHVlKSB7XHJcbiAgICAgICAgJGxvZy5kZWJ1ZygnVGhlIG1vZGVsIGhhcyBjaGFuZ2VkIScsIGl0ZW1JbmRleCwgc2NoZWR1bGVJbmRleCwgc2NoZWR1bGVWYWx1ZSk7XHJcbiAgICAgIH07XHJcblxyXG4gICAgICB0aGlzLm9uTG9jYWxlQ2hhbmdlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICRsb2cuZGVidWcoJ1RoZSBsb2NhbGUgaXMgY2hhbmdpbmcgdG8nLCAkc2NvcGUubW9kZWwubG9jYWxlKTtcclxuICAgICAgICBsb2NhbGVTZXJ2aWNlLnNldCgkc2NvcGUubW9kZWwubG9jYWxlKS50aGVuKGZ1bmN0aW9uICgkbG9jYWxlKSB7XHJcbiAgICAgICAgICAkbG9nLmRlYnVnKCdUaGUgbG9jYWxlIGNoYW5nZWQgdG8nLCAkbG9jYWxlLmlkKTtcclxuICAgICAgICB9KTtcclxuICAgICAgfTtcclxuICAgIH1dKTtcclxuIiwiYW5ndWxhci5tb2R1bGUoJ3dlZWtseVNjaGVkdWxlcicsIFsnbmdXZWVrbHlTY2hlZHVsZXJUZW1wbGF0ZXMnXSk7XHJcblxyXG52YXIgR1JJRF9URU1QTEFURSA9IGFuZ3VsYXIuZWxlbWVudCgnPGRpdiBjbGFzcz1cImdyaWQtaXRlbVwiPjwvZGl2PicpO1xyXG52YXIgQ0xJQ0tfT05fQV9DRUxMID0gJ2NsaWNrT25BQ2VsbCc7XHJcblxyXG52YXIgaXNDdHJsO1xyXG5cclxuZnVuY3Rpb24gY3RybENoZWNrKGUpIHtcclxuICBpZiAoZS53aGljaCA9PT0gMTcpIHtcclxuICAgIGlzQ3RybCA9IGUudHlwZSA9PT0gJ2tleWRvd24nO1xyXG4gIH1cclxufVxyXG5cclxuZnVuY3Rpb24gbW91c2VTY3JvbGwoZWwsIGRlbHRhKSB7XHJcblxyXG4gIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgY3RybENoZWNrKTtcclxuICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigna2V5dXAnLCBjdHJsQ2hlY2spO1xyXG5cclxuICBlbC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZXdoZWVsJywgZnVuY3Rpb24gKGUpIHtcclxuICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcblxyXG4gICAgaWYgKGlzQ3RybCkge1xyXG4gICAgICB2YXIgc3R5bGUgPSBlbC5maXJzdENoaWxkLnN0eWxlLCBjdXJyZW50V2lkdGggPSBwYXJzZUludChzdHlsZS53aWR0aCk7XHJcbiAgICAgIGlmICgoZS53aGVlbERlbHRhIHx8IGUuZGV0YWlsKSA+IDApIHtcclxuICAgICAgICBzdHlsZS53aWR0aCA9IChjdXJyZW50V2lkdGggKyAyICogZGVsdGEpICsgJyUnO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHZhciB3aWR0aCA9IGN1cnJlbnRXaWR0aCAtIDIgKiBkZWx0YTtcclxuICAgICAgICBzdHlsZS53aWR0aCA9ICh3aWR0aCA+IDEwMCA/IHdpZHRoIDogMTAwKSArICclJztcclxuICAgICAgfVxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgaWYgKChlLndoZWVsRGVsdGEgfHwgZS5kZXRhaWwpID4gMCkge1xyXG4gICAgICAgIGVsLnNjcm9sbExlZnQgLT0gZGVsdGE7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgZWwuc2Nyb2xsTGVmdCArPSBkZWx0YTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIGZhbHNlO1xyXG4gIH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiB6b29tSW5BQ2VsbChlbCwgZXZlbnQsIGRhdGEpIHtcclxuXHJcbiAgdmFyIG5iRWxlbWVudHMgPSBkYXRhLm5iRWxlbWVudHM7XHJcbiAgdmFyIGlkeCA9IGRhdGEuaWR4O1xyXG4gIC8vIHBlcmNlbnRXaWR0aEZyb21CZWdpbm5pbmcgaXMgdXNlZCB3aGVuIHRoZSBmaXJzdCBlbGVtZW50IG9mIHRoZSBncmlkIGlzIG5vdCBmdWxsXHJcbiAgLy8gRm9yIGluc3RhbmNlLCBpbiB0aGUgZXhhbXBsZSBiZWxvdyBgZmViIDE3YCBpcyBub3QgZnVsbFxyXG4gIC8vIGZlYiAxNyAgICAgICAgICBtYXJjaCAxN1xyXG4gIC8vICAgICAgIHwgICAgICAgICAgICAgICAgICAgICAgICAgIHxcclxuICB2YXIgcGVyY2VudFdpZHRoRnJvbUJlZ2lubmluZyA9IGRhdGEucGVyY2VudFdpZHRoRnJvbUJlZ2lubmluZztcclxuXHJcbiAgdmFyIGNvbnRhaW5lcldpZHRoID0gZWwub2Zmc2V0V2lkdGg7XHJcblxyXG4gIC8vIGxlYXZlICgxLzMpIGVhY2ggc2lkZVxyXG4gIC8vIDEvMyB8ICAgIDMvMyAgIHwgMS8zXHJcbiAgdmFyIGJveFdpZHRoID0gY29udGFpbmVyV2lkdGggLyAoNSAvIDMpO1xyXG4gIHZhciBndXR0ZXJTaXplID0gYm94V2lkdGggLyAzO1xyXG5cclxuICB2YXIgc2NoZWR1bGVBcmVhV2lkdGhQeCA9IG5iRWxlbWVudHMgKiBib3hXaWR0aDtcclxuICB2YXIgc2NoZWR1bGVBcmVhV2lkdGhQZXJjZW50ID0gKHNjaGVkdWxlQXJlYVdpZHRoUHggLyBjb250YWluZXJXaWR0aCkgKiAxMDA7XHJcblxyXG4gIGVsLmZpcnN0Q2hpbGQuc3R5bGUud2lkdGggPSBzY2hlZHVsZUFyZWFXaWR0aFBlcmNlbnQgKyAnJSc7XHJcblxyXG4gIGlmIChwZXJjZW50V2lkdGhGcm9tQmVnaW5uaW5nID09PSB1bmRlZmluZWQpIHtcclxuICAgIC8vIEFsbCBjZWxscyBvZiBhIGxpbmUgaGF2ZSB0aGUgc2FtZSBzaXplXHJcbiAgICBlbC5zY3JvbGxMZWZ0ID0gaWR4ICogYm94V2lkdGggLSBndXR0ZXJTaXplO1xyXG4gIH0gZWxzZSB7XHJcbiAgICAvLyBTaXplcyBvZiBjZWxscyBpbiBhIGxpbmUgY291bGQgZGlmZmVyZW50IChlc3BlY2lhbGx5IHRoZSBmaXJzdCBvbmUpXHJcbiAgICBlbC5zY3JvbGxMZWZ0ID0gc2NoZWR1bGVBcmVhV2lkdGhQeCAqIChwZXJjZW50V2lkdGhGcm9tQmVnaW5uaW5nIC8gMTAwKSAtIGd1dHRlclNpemU7XHJcbiAgfVxyXG59XHJcbiIsImNsYXNzIEhhbmRsZURpcmVjdGl2ZSBpbXBsZW1lbnRzIGFuZ3VsYXIuSURpcmVjdGl2ZSB7XHJcbiAgc3RhdGljICRuYW1lID0gJ2hhbmRsZSc7XHJcbiAgcmVzdHJpY3QgPSAnQSc7XHJcblxyXG4gIHNjb3BlID0ge1xyXG4gICAgb25kcmFnOiAnPScsXHJcbiAgICBvbmRyYWdzdG9wOiAnPScsXHJcbiAgICBvbmRyYWdzdGFydDogJz0nXHJcbiAgfTtcclxuXHJcbiAgbGluayA9IChzY29wZSwgZWxlbWVudDogYW5ndWxhci5JQXVnbWVudGVkSlF1ZXJ5KSA9PiB7XHJcbiAgICB2YXIgJGRvY3VtZW50ID0gdGhpcy4kZG9jdW1lbnQ7XHJcbiAgICB2YXIgeCA9IDA7XHJcbiAgICBcclxuICAgIGVsZW1lbnQub24oJ21vdXNlZG93bicsIChldmVudCkgPT4ge1xyXG4gICAgICAvLyBQcmV2ZW50IGRlZmF1bHQgZHJhZ2dpbmcgb2Ygc2VsZWN0ZWQgY29udGVudFxyXG4gICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuICAgICAgeCA9IGV2ZW50LnBhZ2VYO1xyXG5cclxuICAgICAgJGRvY3VtZW50Lm9uKCdtb3VzZW1vdmUnLCBtb3VzZW1vdmUpO1xyXG4gICAgICAkZG9jdW1lbnQub24oJ21vdXNldXAnLCBtb3VzZXVwKTtcclxuXHJcbiAgICAgIGlmIChzY29wZS5vbmRyYWdzdGFydCkge1xyXG4gICAgICAgIHNjb3BlLm9uZHJhZ3N0YXJ0KCk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIGZ1bmN0aW9uIG1vdXNlbW92ZShldmVudCkge1xyXG4gICAgICB2YXIgZGVsdGEgPSBldmVudC5wYWdlWCAtIHg7XHJcbiAgICAgIGlmIChzY29wZS5vbmRyYWcpIHtcclxuICAgICAgICBzY29wZS5vbmRyYWcoZGVsdGEpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gbW91c2V1cCgpIHtcclxuICAgICAgJGRvY3VtZW50LnVuYmluZCgnbW91c2Vtb3ZlJywgbW91c2Vtb3ZlKTtcclxuICAgICAgJGRvY3VtZW50LnVuYmluZCgnbW91c2V1cCcsIG1vdXNldXApO1xyXG5cclxuICAgICAgaWYgKHNjb3BlLm9uZHJhZ3N0b3ApIHtcclxuICAgICAgICBzY29wZS5vbmRyYWdzdG9wKCk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcblxyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAgcHJpdmF0ZSAkZG9jdW1lbnQ6IGFuZ3VsYXIuSURvY3VtZW50U2VydmljZVxyXG4gICkge1xyXG4gIH1cclxuXHJcbiAgc3RhdGljIEZhY3RvcnkoKSB7XHJcbiAgICBsZXQgZGlyZWN0aXZlID0gKCRkb2N1bWVudCkgPT4gbmV3IEhhbmRsZURpcmVjdGl2ZSgkZG9jdW1lbnQpO1xyXG5cclxuICAgIGRpcmVjdGl2ZS4kaW5qZWN0ID0gWyckZG9jdW1lbnQnXTtcclxuXHJcbiAgICByZXR1cm4gZGlyZWN0aXZlO1xyXG4gIH1cclxufVxyXG5cclxuYW5ndWxhci5tb2R1bGUoJ3dlZWtseVNjaGVkdWxlcicpXHJcbiAgLmRpcmVjdGl2ZShIYW5kbGVEaXJlY3RpdmUuJG5hbWUsIEhhbmRsZURpcmVjdGl2ZS5GYWN0b3J5KCkpO1xyXG4iLCJjbGFzcyBIb3VybHlHcmlkRGlyZWN0aXZlIGltcGxlbWVudHMgYW5ndWxhci5JRGlyZWN0aXZlIHtcclxuICAgIHN0YXRpYyAkbmFtZSA9ICdob3VybHlHcmlkJztcclxuXHJcbiAgICByZXN0cmljdCA9ICdFJztcclxuICAgIHJlcXVpcmUgPSAnXndlZWtseVNjaGVkdWxlcic7XHJcblxyXG4gICAgcHJpdmF0ZSBoYW5kbGVDbGlja0V2ZW50KGNoaWxkLCBuYkhvdXJzLCBpZHgsIHNjb3BlKSB7XHJcbiAgICAgICAgY2hpbGQuYmluZCgnY2xpY2snLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICBzY29wZS4kYnJvYWRjYXN0KENMSUNLX09OX0FfQ0VMTCwge1xyXG4gICAgICAgICAgICBuYkVsZW1lbnRzOiBuYkhvdXJzLFxyXG4gICAgICAgICAgICBpZHg6IGlkeFxyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBkb0dyaWQoc2NvcGUsIGVsZW1lbnQsIGF0dHJzLCBtb2RlbCkge1xyXG4gICAgICAgIHZhciBpO1xyXG4gICAgICAgIC8vIENhbGN1bGF0ZSBob3VyIHdpZHRoIGRpc3RyaWJ1dGlvblxyXG4gICAgICAgIHZhciB0aWNrY291bnQgPSBtb2RlbC5uYkhvdXJzO1xyXG4gICAgICAgIHZhciB0aWNrc2l6ZSA9IDEwMCAvIHRpY2tjb3VudDtcclxuICAgICAgICB2YXIgZ3JpZEl0ZW1FbCA9IEdSSURfVEVNUExBVEUuY3NzKHt3aWR0aDogdGlja3NpemUgKyAnJSd9KTtcclxuICBcclxuICAgICAgICAvLyBDbGVhbiBlbGVtZW50XHJcbiAgICAgICAgZWxlbWVudC5lbXB0eSgpO1xyXG4gIFxyXG4gICAgICAgIGZvciAoaSA9IDA7IGkgPCB0aWNrY291bnQ7IGkrKykge1xyXG4gICAgICAgICAgdmFyIGNoaWxkID0gZ3JpZEl0ZW1FbC5jbG9uZSgpO1xyXG5cclxuICAgICAgICAgIGlmIChhbmd1bGFyLmlzVW5kZWZpbmVkKGF0dHJzLm5vVGV4dCkpIHtcclxuICAgICAgICAgICAgdGhpcy5oYW5kbGVDbGlja0V2ZW50KGNoaWxkLCB0aWNrY291bnQsIGksIHNjb3BlKTtcclxuXHJcbiAgICAgICAgICAgIGxldCBjdXJyZW50SG91ciA9IGkgJSAxMjtcclxuICAgICAgICAgICAgbGV0IG1lcmlkaWVtID0gaSA+PSAxMiA/ICdwbScgOiAnYW0nO1xyXG5cclxuICAgICAgICAgICAgY2hpbGQudGV4dChgJHtjdXJyZW50SG91ciB8fCAnMTInfSR7bWVyaWRpZW19YCk7XHJcbiAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgZWxlbWVudC5hcHBlbmQoY2hpbGQpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBsaW5rID0gKHNjb3BlLCBlbGVtZW50LCBhdHRycywgc2NoZWR1bGVyQ3RybDogV2Vla2x5U2NoZWR1bGVyQ29udHJvbGxlcikgPT4ge1xyXG4gICAgICAgIGlmIChzY2hlZHVsZXJDdHJsLmNvbmZpZykge1xyXG4gICAgICAgICAgICB0aGlzLmRvR3JpZChzY29wZSwgZWxlbWVudCwgYXR0cnMsIHNjaGVkdWxlckN0cmwuY29uZmlnKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHNjaGVkdWxlckN0cmwuJG1vZGVsQ2hhbmdlTGlzdGVuZXJzLnB1c2goKG5ld01vZGVsKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuZG9HcmlkKHNjb3BlLCBlbGVtZW50LCBhdHRycywgbmV3TW9kZWwpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIHN0YXRpYyBGYWN0b3J5KCkge1xyXG4gICAgICAgIGxldCBkaXJlY3RpdmUgPSAoKSA9PiBuZXcgSG91cmx5R3JpZERpcmVjdGl2ZSgpO1xyXG5cclxuICAgICAgICByZXR1cm4gZGlyZWN0aXZlO1xyXG4gICAgfVxyXG59XHJcblxyXG5hbmd1bGFyXHJcbiAgICAubW9kdWxlKCd3ZWVrbHlTY2hlZHVsZXInKVxyXG4gICAgLmRpcmVjdGl2ZShIb3VybHlHcmlkRGlyZWN0aXZlLiRuYW1lLCBIb3VybHlHcmlkRGlyZWN0aXZlLkZhY3RvcnkoKSk7XHJcbiIsImNsYXNzIEluamVjdERpcmVjdGl2ZSBpbXBsZW1lbnRzIGFuZ3VsYXIuSURpcmVjdGl2ZSB7XHJcbiAgc3RhdGljICRuYW1lID0gJ2luamVjdCc7XHJcblxyXG4gIGxpbmsgPSAoJHNjb3BlOiBhbmd1bGFyLklTY29wZSwgJGVsZW1lbnQ6IGFuZ3VsYXIuSUF1Z21lbnRlZEpRdWVyeSwgJGF0dHJzOiBhbmd1bGFyLklBdHRyaWJ1dGVzLCBjb250cm9sbGVyLCAkdHJhbnNjbHVkZTogYW5ndWxhci5JVHJhbnNjbHVkZUZ1bmN0aW9uKSA9PiB7XHJcbiAgICBpZiAoISR0cmFuc2NsdWRlKSB7XHJcbiAgICAgIHRocm93ICdJbGxlZ2FsIHVzZSBvZiBuZ1RyYW5zY2x1ZGUgZGlyZWN0aXZlIGluIHRoZSB0ZW1wbGF0ZSEgTm8gcGFyZW50IGRpcmVjdGl2ZSB0aGF0IHJlcXVpcmVzIGEgdHJhbnNjbHVzaW9uIGZvdW5kLic7XHJcbiAgICB9XHJcblxyXG4gICAgdmFyIGlubmVyU2NvcGUgPSAkc2NvcGUuJG5ldygpO1xyXG5cclxuICAgICR0cmFuc2NsdWRlKGlubmVyU2NvcGUsIGZ1bmN0aW9uIChjbG9uZSkge1xyXG4gICAgICAkZWxlbWVudC5lbXB0eSgpO1xyXG4gICAgICAkZWxlbWVudC5hcHBlbmQoY2xvbmUpO1xyXG4gICAgICAkZWxlbWVudC5vbignJGRlc3Ryb3knLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaW5uZXJTY29wZS4kZGVzdHJveSgpO1xyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgc3RhdGljIEZhY3RvcnkoKSB7XHJcbiAgICBsZXQgZGlyZWN0aXZlID0gKCkgPT4gbmV3IEluamVjdERpcmVjdGl2ZSgpO1xyXG4gICAgXHJcbiAgICByZXR1cm4gZGlyZWN0aXZlO1xyXG4gIH1cclxufVxyXG5cclxuYW5ndWxhclxyXG4gIC5tb2R1bGUoJ3dlZWtseVNjaGVkdWxlcicpXHJcbiAgLmRpcmVjdGl2ZShJbmplY3REaXJlY3RpdmUuJG5hbWUsIEluamVjdERpcmVjdGl2ZS5GYWN0b3J5KCkpO1xyXG4iLCJhbmd1bGFyLm1vZHVsZSgnd2Vla2x5U2NoZWR1bGVySTE4TicsIFsndG1oLmR5bmFtaWNMb2NhbGUnXSk7XHJcblxyXG5hbmd1bGFyLm1vZHVsZSgnd2Vla2x5U2NoZWR1bGVySTE4TicpXHJcbiAgLnByb3ZpZGVyKCd3ZWVrbHlTY2hlZHVsZXJMb2NhbGVTZXJ2aWNlJywgWyd0bWhEeW5hbWljTG9jYWxlUHJvdmlkZXInLCBmdW5jdGlvbiAodG1oRHluYW1pY0xvY2FsZVByb3ZpZGVyKSB7XHJcblxyXG4gICAgdmFyIGRlZmF1bHRDb25maWc6IGFueSAvKiBUT0RPIHR5cGUgKi8gPSB7XHJcbiAgICAgIGRveXM6IHsnZGUtZGUnOiA0LCAnZW4tZ2InOiA0LCAnZW4tdXMnOiA2LCAnZnItZnInOiA0fSxcclxuICAgICAgbGFuZzoge1xyXG4gICAgICAgICdkZS1kZSc6IHt3ZWVrTmI6ICdXb2NoZW51bW1lcicsIGFkZE5ldzogJ0hpbnp1ZsO8Z2VuJ30sXHJcbiAgICAgICAgJ2VuLWdiJzoge3dlZWtOYjogJ1dlZWsgIycsIGFkZE5ldzogJ0FkZCd9LFxyXG4gICAgICAgICdlbi11cyc6IHt3ZWVrTmI6ICdXZWVrICMnLCBhZGROZXc6ICdBZGQnfSxcclxuICAgICAgICAnZnItZnInOiB7d2Vla05iOiAnTsKwIGRlIHNlbWFpbmUnLCBhZGROZXc6ICdBam91dGVyJ31cclxuICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICB0aGlzLmNvbmZpZ3VyZSA9IGZ1bmN0aW9uIChjb25maWcpIHtcclxuXHJcbiAgICAgIGlmIChjb25maWcgJiYgYW5ndWxhci5pc09iamVjdChjb25maWcpKSB7XHJcbiAgICAgICAgYW5ndWxhci5tZXJnZShkZWZhdWx0Q29uZmlnLCBjb25maWcpO1xyXG5cclxuICAgICAgICBpZiAoZGVmYXVsdENvbmZpZy5sb2NhbGVMb2NhdGlvblBhdHRlcm4pIHtcclxuICAgICAgICAgIHRtaER5bmFtaWNMb2NhbGVQcm92aWRlci5sb2NhbGVMb2NhdGlvblBhdHRlcm4oZGVmYXVsdENvbmZpZy5sb2NhbGVMb2NhdGlvblBhdHRlcm4pO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICB0aGlzLiRnZXQgPSBbJyRyb290U2NvcGUnLCAnJGxvY2FsZScsICd0bWhEeW5hbWljTG9jYWxlJywgZnVuY3Rpb24gKCRyb290U2NvcGUsICRsb2NhbGUsIHRtaER5bmFtaWNMb2NhbGUpIHtcclxuXHJcbiAgICAgIHZhciBtb21lbnRMb2NhbGVDYWNoZSA9IHt9O1xyXG5cclxuICAgICAgZnVuY3Rpb24gZ2V0TGFuZygpIHtcclxuICAgICAgICB2YXIga2V5ID0gJGxvY2FsZS5pZDtcclxuICAgICAgICBpZiAoIW1vbWVudExvY2FsZUNhY2hlW2tleV0pIHtcclxuICAgICAgICAgIG1vbWVudExvY2FsZUNhY2hlW2tleV0gPSBnZXRNb21lbnRMb2NhbGUoa2V5KTtcclxuICAgICAgICAgIG1vbWVudC5sb2NhbGUobW9tZW50TG9jYWxlQ2FjaGVba2V5XS5pZCwgbW9tZW50TG9jYWxlQ2FjaGVba2V5XS5sb2NhbGUpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBtb21lbnQubG9jYWxlKG1vbWVudExvY2FsZUNhY2hlW2tleV0uaWQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gZGVmYXVsdENvbmZpZy5sYW5nW2tleV07XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8vIFdlIGp1c3QgbmVlZCBmZXcgbW9tZW50IGxvY2FsIGluZm9ybWF0aW9uXHJcbiAgICAgIGZ1bmN0aW9uIGdldE1vbWVudExvY2FsZShrZXkpIHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgaWQ6IGtleSxcclxuICAgICAgICAgIGxvY2FsZToge1xyXG4gICAgICAgICAgICB3ZWVrOiB7XHJcbiAgICAgICAgICAgICAgLy8gQW5ndWxhciBtb25kYXkgPSAwIHdoZXJlYXMgTW9tZW50IG1vbmRheSA9IDFcclxuICAgICAgICAgICAgICBkb3c6ICgkbG9jYWxlLkRBVEVUSU1FX0ZPUk1BVFMuRklSU1REQVlPRldFRUsgKyAxKSAlIDcsXHJcbiAgICAgICAgICAgICAgZG95OiBkZWZhdWx0Q29uZmlnLmRveXNba2V5XVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgfVxyXG5cclxuICAgICAgJHJvb3RTY29wZS4kb24oJyRsb2NhbGVDaGFuZ2VTdWNjZXNzJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICRyb290U2NvcGUuJGJyb2FkY2FzdCgnd2Vla2x5U2NoZWR1bGVyTG9jYWxlQ2hhbmdlZCcsIGdldExhbmcoKSk7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgcmV0dXJuIHtcclxuICAgICAgICAkbG9jYWxlOiAkbG9jYWxlLFxyXG4gICAgICAgIGdldExhbmc6IGdldExhbmcsXHJcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAoa2V5KSB7XHJcbiAgICAgICAgICByZXR1cm4gdG1oRHluYW1pY0xvY2FsZS5zZXQoa2V5KTtcclxuICAgICAgICB9XHJcbiAgICAgIH07XHJcbiAgICB9XTtcclxuICB9XSk7IiwiY2xhc3MgTXVsdGlTbGlkZXJEaXJlY3RpdmUgaW1wbGVtZW50cyBhbmd1bGFyLklEaXJlY3RpdmUge1xyXG4gIHN0YXRpYyAkbmFtZSA9ICdtdWx0aVNsaWRlcic7XHJcblxyXG4gIHJlc3RyaWN0ID0gJ0UnO1xyXG4gIHJlcXVpcmUgPSAnXndlZWtseVNjaGVkdWxlcic7XHJcbiAgdGVtcGxhdGVVcmwgPSAnbmctd2Vla2x5LXNjaGVkdWxlci9tdWx0aXNsaWRlci9tdWx0aXNsaWRlci5odG1sJztcclxuXHJcbiAgY29uc3RydWN0b3IoXHJcbiAgICBwcml2YXRlIHRpbWVTZXJ2aWNlOiBXZWVrbHlTY2hlZHVsZXJUaW1lU2VydmljZVxyXG4gICkge1xyXG4gIH1cclxuXHJcbiAgbGluayA9IChzY29wZSwgZWxlbWVudDogYW5ndWxhci5JQXVnbWVudGVkSlF1ZXJ5LCBhdHRyczogYW5ndWxhci5JQXR0cmlidXRlcywgc2NoZWR1bGVyQ3RybCkgPT4ge1xyXG4gICAgdmFyIGNvbmYgPSBzY2hlZHVsZXJDdHJsLmNvbmZpZztcclxuXHJcbiAgICAvLyBUaGUgZGVmYXVsdCBzY2hlZHVsZXIgYmxvY2sgc2l6ZSB3aGVuIGFkZGluZyBhIG5ldyBpdGVtXHJcbiAgICB2YXIgZGVmYXVsdE5ld1NjaGVkdWxlU2l6ZSA9IHBhcnNlSW50KGF0dHJzLnNpemUpIHx8IDg7XHJcblxyXG4gICAgdmFyIHZhbFRvUGl4ZWwgPSBmdW5jdGlvbiAodmFsKSB7XHJcbiAgICAgIHZhciBwZXJjZW50ID0gdmFsIC8gKGNvbmYubmJIb3Vycyk7XHJcbiAgICAgIHJldHVybiBNYXRoLmZsb29yKHBlcmNlbnQgKiBlbGVtZW50WzBdLmNsaWVudFdpZHRoICsgMC41KTtcclxuICAgIH07XHJcblxyXG4gICAgdmFyIHBpeGVsVG9WYWwgPSBmdW5jdGlvbiAocGl4ZWwpIHtcclxuICAgICAgdmFyIHBlcmNlbnQgPSBwaXhlbCAvIGVsZW1lbnRbMF0uY2xpZW50V2lkdGg7XHJcbiAgICAgIHJldHVybiBNYXRoLmZsb29yKHBlcmNlbnQgKiAoY29uZi5uYkhvdXJzKSArIDAuNSk7XHJcbiAgICB9O1xyXG5cclxuICAgIHZhciBhZGRTbG90ID0gKHN0YXJ0LCBlbmQpID0+IHtcclxuICAgICAgc3RhcnQgPSBzdGFydCA+PSAwID8gc3RhcnQgOiAwO1xyXG4gICAgICBlbmQgPSBlbmQgPD0gY29uZi5uYkhvdXJzID8gZW5kIDogY29uZi5uYkhvdXJzO1xyXG5cclxuICAgICAgdmFyIHN0YXJ0RGF0ZSA9IHRoaXMudGltZVNlcnZpY2UuYWRkSG91cihjb25mLm1pbkRhdGUsIHN0YXJ0KTtcclxuICAgICAgdmFyIGVuZERhdGUgPSB0aGlzLnRpbWVTZXJ2aWNlLmFkZEhvdXIoY29uZi5taW5EYXRlLCBlbmQpO1xyXG5cclxuICAgICAgc2NvcGUuJGFwcGx5KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgaXRlbSA9IHNjb3BlLml0ZW07XHJcbiAgICAgICAgaWYgKCFpdGVtLnNjaGVkdWxlcykge1xyXG4gICAgICAgICAgaXRlbS5zY2hlZHVsZXMgPSBbXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaXRlbS5zY2hlZHVsZXMucHVzaCh7c3RhcnQ6IHN0YXJ0RGF0ZS50b0RhdGUoKSwgZW5kOiBlbmREYXRlLnRvRGF0ZSgpfSk7XHJcbiAgICAgIH0pO1xyXG4gICAgfTtcclxuXHJcbiAgICB2YXIgaG92ZXJFbGVtZW50ID0gYW5ndWxhci5lbGVtZW50KGVsZW1lbnQuZmluZCgnZGl2JylbMF0pO1xyXG4gICAgdmFyIGhvdmVyRWxlbWVudFdpZHRoID0gdmFsVG9QaXhlbChkZWZhdWx0TmV3U2NoZWR1bGVTaXplKTtcclxuXHJcbiAgICBob3ZlckVsZW1lbnQuY3NzKHtcclxuICAgICAgd2lkdGg6IGhvdmVyRWxlbWVudFdpZHRoICsgJ3B4J1xyXG4gICAgfSk7XHJcblxyXG4gICAgZWxlbWVudC5vbignbW91c2Vtb3ZlJywgZnVuY3Rpb24gKGUpIHtcclxuICAgICAgdmFyIGVsT2ZmWCA9IGVsZW1lbnRbMF0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkubGVmdDtcclxuXHJcbiAgICAgIGhvdmVyRWxlbWVudC5jc3Moe1xyXG4gICAgICAgIGxlZnQ6IGUucGFnZVggLSBlbE9mZlggLSBob3ZlckVsZW1lbnRXaWR0aCAvIDIgKyAncHgnXHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaG92ZXJFbGVtZW50Lm9uKCdjbGljaycsIGZ1bmN0aW9uIChldmVudCkge1xyXG4gICAgICBpZiAoIWVsZW1lbnQuYXR0cignbm8tYWRkJykpIHtcclxuICAgICAgICB2YXIgZWxPZmZYID0gZWxlbWVudFswXS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5sZWZ0O1xyXG4gICAgICAgIHZhciBwaXhlbE9uQ2xpY2sgPSBldmVudC5wYWdlWCAtIGVsT2ZmWDtcclxuICAgICAgICB2YXIgdmFsT25DbGljayA9IHBpeGVsVG9WYWwocGl4ZWxPbkNsaWNrKTtcclxuXHJcbiAgICAgICAgdmFyIHN0YXJ0ID0gTWF0aC5yb3VuZCh2YWxPbkNsaWNrIC0gZGVmYXVsdE5ld1NjaGVkdWxlU2l6ZSAvIDIpO1xyXG4gICAgICAgIHZhciBlbmQgPSBzdGFydCArIGRlZmF1bHROZXdTY2hlZHVsZVNpemU7XHJcblxyXG4gICAgICAgIGFkZFNsb3Qoc3RhcnQsIGVuZCk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgc3RhdGljIEZhY3RvcnkoKSB7XHJcbiAgICBsZXQgZGlyZWN0aXZlID0gKHRpbWVTZXJ2aWNlKSA9PiBuZXcgTXVsdGlTbGlkZXJEaXJlY3RpdmUodGltZVNlcnZpY2UpO1xyXG5cclxuICAgIGRpcmVjdGl2ZS4kaW5qZWN0ID0gW1xyXG4gICAgICAnd2Vla2x5U2NoZWR1bGVyVGltZVNlcnZpY2UnXHJcbiAgICBdO1xyXG5cclxuICAgIHJldHVybiBkaXJlY3RpdmU7XHJcbiAgfVxyXG59XHJcblxyXG5hbmd1bGFyLm1vZHVsZSgnd2Vla2x5U2NoZWR1bGVyJylcclxuICAuZGlyZWN0aXZlKE11bHRpU2xpZGVyRGlyZWN0aXZlLiRuYW1lLCBNdWx0aVNsaWRlckRpcmVjdGl2ZS5GYWN0b3J5KCkpO1xyXG4iLCJjbGFzcyBXZWVrbHlTY2hlZHVsZXJUaW1lU2VydmljZSB7XHJcbiAgc3RhdGljICRuYW1lID0gJ3dlZWtseVNjaGVkdWxlclRpbWVTZXJ2aWNlJztcclxuXHJcbiAgcHJpdmF0ZSBXRUVLID0gJ3dlZWsnO1xyXG4gIHByaXZhdGUgSE9VUiA9ICdob3VyJztcclxuXHJcbiAgcHVibGljIGFkZEhvdXIobW9tZW50LCBuYkhvdXIpIHtcclxuICAgIHJldHVybiBtb21lbnQuY2xvbmUoKS5hZGQobmJIb3VyLCAnaG91cicpO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIGNvbXBhcmUoZGF0ZSwgbWV0aG9kLCBsYXN0TWluKSB7XHJcbiAgICBpZiAoZGF0ZSkge1xyXG4gICAgICB2YXIgZGF0ZUFzTW9tZW50O1xyXG4gICAgICBpZiAoYW5ndWxhci5pc0RhdGUoZGF0ZSkpIHtcclxuICAgICAgICBkYXRlQXNNb21lbnQgPSBtb21lbnQoZGF0ZSk7XHJcbiAgICAgIH0gZWxzZSBpZiAoZGF0ZS5faXNBTW9tZW50T2JqZWN0KSB7XHJcbiAgICAgICAgZGF0ZUFzTW9tZW50ID0gZGF0ZTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICB0aHJvdyAnQ291bGQgbm90IHBhcnNlIGRhdGUgWycgKyBkYXRlICsgJ10nO1xyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiBkYXRlQXNNb21lbnRbbWV0aG9kXShsYXN0TWluKSA/IGRhdGVBc01vbWVudCA6IGxhc3RNaW47XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgaG91clByZWNpc2VEaWZmKHN0YXJ0LCBlbmQpIHtcclxuICAgIHJldHVybiBlbmQuY2xvbmUoKS5kaWZmKHN0YXJ0LmNsb25lKCksIHRoaXMuSE9VUiwgdHJ1ZSk7XHJcbiAgfVxyXG59XHJcblxyXG5hbmd1bGFyLm1vZHVsZSgnd2Vla2x5U2NoZWR1bGVyJylcclxuICAuc2VydmljZShXZWVrbHlTY2hlZHVsZXJUaW1lU2VydmljZS4kbmFtZSwgV2Vla2x5U2NoZWR1bGVyVGltZVNlcnZpY2UpO1xyXG4iLCJjbGFzcyBXZWVrbHlTY2hlZHVsZXJDb250cm9sbGVyIGltcGxlbWVudHMgYW5ndWxhci5JQ29udHJvbGxlciB7XHJcbiAgc3RhdGljICRjb250cm9sbGVyQXMgPSAnc2NoZWR1bGVyQ3RybCc7XHJcbiAgc3RhdGljICRuYW1lID0gJ3dlZWtseVNjaGVkdWxlckNvbnRyb2xsZXInO1xyXG5cclxuICBzdGF0aWMgJGluamVjdCA9IFtcclxuICAgICckaW5qZWN0b3InLFxyXG4gICAgJyRsb2cnXHJcbiAgXTtcclxuXHJcbiAgY29uc3RydWN0b3IoXHJcbiAgICBwcml2YXRlICRpbmplY3RvcjogYW5ndWxhci5hdXRvLklJbmplY3RvclNlcnZpY2UsXHJcbiAgICBwcml2YXRlICRsb2c6IGFuZ3VsYXIuSUxvZ1NlcnZpY2VcclxuICApIHtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBjb25maWc6IGFueTsgLyogVE9ETyB0eXBlICovXHJcbiAgcHVibGljIGl0ZW1zOiBhbnlbXTsgLyogVE9ETyB0eXBlICovXHJcblxyXG4gIHB1YmxpYyBkZWZhdWx0T3B0aW9uczogYW55IC8qIFRPRE8gdHlwZSAqLyA9IHtcclxuICAgIG1vbm9TY2hlZHVsZTogZmFsc2UsXHJcbiAgICBzZWxlY3RvcjogJy5zY2hlZHVsZS1hcmVhLWNvbnRhaW5lcidcclxuICB9O1xyXG5cclxuICBwdWJsaWMgb246IHtcclxuICAgIGNoYW5nZTogKGl0ZW1JbmRleCwgc2NoZWR1bGVJbmRleCwgc2NoZWR1bGVWYWx1ZSkgPT4gRnVuY3Rpb247XHJcbiAgfTtcclxuXHJcbiAgcHVibGljICRtb2RlbENoYW5nZUxpc3RlbmVyczogRnVuY3Rpb25bXTsgLyogVE9ETyB0eXBlICovXHJcblxyXG4gICRvbkluaXQoKSB7XHJcbiAgICAvLyBUcnkgdG8gZ2V0IHRoZSBpMThuIHNlcnZpY2VcclxuICAgIHZhciBuYW1lID0gJ3dlZWtseVNjaGVkdWxlckxvY2FsZVNlcnZpY2UnO1xyXG5cclxuICAgIGlmICh0aGlzLiRpbmplY3Rvci5oYXMobmFtZSkpIHtcclxuICAgICAgdGhpcy4kbG9nLmluZm8oJ1RoZSBJMThOIHNlcnZpY2UgaGFzIHN1Y2Nlc3NmdWxseSBiZWVuIGluaXRpYWxpemVkIScpO1xyXG5cclxuICAgICAgdmFyIGxvY2FsZVNlcnZpY2U6IGFueSA9IHRoaXMuJGluamVjdG9yLmdldChuYW1lKTsgLyogVE9ETyB0eXBlICovXHJcbiAgICAgIHRoaXMuZGVmYXVsdE9wdGlvbnMubGFiZWxzID0gbG9jYWxlU2VydmljZS5nZXRMYW5nKCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLiRsb2cuaW5mbygnTm8gSTE4TiBmb3VuZCBmb3IgdGhpcyBtb2R1bGUsIGNoZWNrIHRoZSBuZyBtb2R1bGUgW3dlZWtseVNjaGVkdWxlckkxOE5dIGlmIHlvdSBuZWVkIGkxOG4uJyk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gV2lsbCBoYW5nIG91ciBtb2RlbCBjaGFuZ2UgbGlzdGVuZXJzXHJcbiAgICB0aGlzLiRtb2RlbENoYW5nZUxpc3RlbmVycyA9IFtdO1xyXG4gIH1cclxufVxyXG5cclxuY2xhc3MgV2Vla2x5U2NoZWR1bGVyRGlyZWN0aXZlIGltcGxlbWVudHMgYW5ndWxhci5JRGlyZWN0aXZlIHtcclxuICBzdGF0aWMgJG5hbWUgPSAnd2Vla2x5U2NoZWR1bGVyJztcclxuXHJcbiAgY29uc3RydWN0b3IoXHJcbiAgICBwcml2YXRlICRsb2c6IGFuZ3VsYXIuSUxvZ1NlcnZpY2UsXHJcbiAgICBwcml2YXRlICRwYXJzZTogYW5ndWxhci5JUGFyc2VTZXJ2aWNlLFxyXG4gICAgcHJpdmF0ZSB0aW1lU2VydmljZTogV2Vla2x5U2NoZWR1bGVyVGltZVNlcnZpY2VcclxuICApIHtcclxuICB9XHJcblxyXG4gIHJlc3RyaWN0ID0gJ0UnO1xyXG4gIHJlcXVpcmUgPSAnd2Vla2x5U2NoZWR1bGVyJztcclxuICB0cmFuc2NsdWRlID0gdHJ1ZTtcclxuICB0ZW1wbGF0ZVVybCA9ICduZy13ZWVrbHktc2NoZWR1bGVyL3dlZWtseS1zY2hlZHVsZXIvd2Vla2x5LXNjaGVkdWxlci5odG1sJztcclxuICBjb250cm9sbGVyID0gV2Vla2x5U2NoZWR1bGVyQ29udHJvbGxlci4kbmFtZTtcclxuICBjb250cm9sbGVyQXMgPSBXZWVrbHlTY2hlZHVsZXJDb250cm9sbGVyLiRjb250cm9sbGVyQXM7XHJcblxyXG4gIGxpbmsgPSAoc2NvcGUsIGVsZW1lbnQsIGF0dHJzLCBzY2hlZHVsZXJDdHJsOiBXZWVrbHlTY2hlZHVsZXJDb250cm9sbGVyKSA9PiB7XHJcbiAgICB2YXIgb3B0aW9uc0ZuID0gdGhpcy4kcGFyc2UoYXR0cnMub3B0aW9ucyksXHJcbiAgICAgIG9wdGlvbnMgPSBhbmd1bGFyLmV4dGVuZChzY2hlZHVsZXJDdHJsLmRlZmF1bHRPcHRpb25zLCBvcHRpb25zRm4oc2NvcGUpIHx8IHt9KTtcclxuXHJcbiAgICAvLyBHZXQgdGhlIHNjaGVkdWxlIGNvbnRhaW5lciBlbGVtZW50XHJcbiAgICB2YXIgZWwgPSBlbGVtZW50WzBdLnF1ZXJ5U2VsZWN0b3Ioc2NoZWR1bGVyQ3RybC5kZWZhdWx0T3B0aW9ucy5zZWxlY3Rvcik7XHJcbiAgICB2YXIgc2VsZjogV2Vla2x5U2NoZWR1bGVyRGlyZWN0aXZlID0gdGhpcztcclxuXHJcbiAgICBmdW5jdGlvbiBvbk1vZGVsQ2hhbmdlKGl0ZW1zKSB7XHJcbiAgICAgIC8vIENoZWNrIGl0ZW1zIGFyZSBwcmVzZW50XHJcbiAgICAgIGlmIChpdGVtcykge1xyXG5cclxuICAgICAgICAvLyBDaGVjayBpdGVtcyBhcmUgaW4gYW4gQXJyYXlcclxuICAgICAgICBpZiAoIWFuZ3VsYXIuaXNBcnJheShpdGVtcykpIHtcclxuICAgICAgICAgIHRocm93ICdZb3Ugc2hvdWxkIHVzZSB3ZWVrbHktc2NoZWR1bGVyIGRpcmVjdGl2ZSB3aXRoIGFuIEFycmF5IG9mIGl0ZW1zJztcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIEtlZXAgdHJhY2sgb2Ygb3VyIG1vZGVsICh1c2UgaXQgaW4gdGVtcGxhdGUpXHJcbiAgICAgICAgc2NoZWR1bGVyQ3RybC5pdGVtcyA9IGl0ZW1zO1xyXG5cclxuICAgICAgICAvLyBGaXJzdCBjYWxjdWxhdGUgY29uZmlndXJhdGlvblxyXG4gICAgICAgIHNjaGVkdWxlckN0cmwuY29uZmlnID0gc2VsZi5jb25maWcoaXRlbXMucmVkdWNlKChyZXN1bHQsIGl0ZW0pID0+IHtcclxuICAgICAgICAgIHZhciBzY2hlZHVsZXMgPSBpdGVtLnNjaGVkdWxlcztcclxuXHJcbiAgICAgICAgICByZXR1cm4gcmVzdWx0LmNvbmNhdChzY2hlZHVsZXMgJiYgc2NoZWR1bGVzLmxlbmd0aCA/XHJcbiAgICAgICAgICAgIC8vIElmIGluIG11bHRpU2xpZGVyIG1vZGUsIGVuc3VyZSBhIHNjaGVkdWxlIGFycmF5IGlzIHByZXNlbnQgb24gZWFjaCBpdGVtXHJcbiAgICAgICAgICAgIC8vIEVsc2Ugb25seSB1c2UgZmlyc3QgZWxlbWVudCBvZiBzY2hlZHVsZSBhcnJheVxyXG4gICAgICAgICAgICAob3B0aW9ucy5tb25vU2NoZWR1bGUgPyBpdGVtLnNjaGVkdWxlcyA9IFtzY2hlZHVsZXNbMF1dIDogc2NoZWR1bGVzKSA6XHJcbiAgICAgICAgICAgIGl0ZW0uc2NoZWR1bGVzID0gW11cclxuICAgICAgICAgICk7XHJcbiAgICAgICAgfSwgW10pLCBvcHRpb25zKTtcclxuXHJcbiAgICAgICAgLy8gRmluYWxseSwgcnVuIHRoZSBzdWIgZGlyZWN0aXZlcyBsaXN0ZW5lcnNcclxuICAgICAgICBzY2hlZHVsZXJDdHJsLiRtb2RlbENoYW5nZUxpc3RlbmVycy5mb3JFYWNoKGZ1bmN0aW9uIChsaXN0ZW5lcikge1xyXG4gICAgICAgICAgbGlzdGVuZXIoc2NoZWR1bGVyQ3RybC5jb25maWcpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKGVsKSB7XHJcbiAgICAgIC8vIEluc3RhbGwgbW91c2Ugc2Nyb2xsaW5nIGV2ZW50IGxpc3RlbmVyIGZvciBIIHNjcm9sbGluZ1xyXG4gICAgICBtb3VzZVNjcm9sbChlbCwgMjApO1xyXG5cclxuICAgICAgc2NvcGUuJG9uKENMSUNLX09OX0FfQ0VMTCwgZnVuY3Rpb24gKGUsIGRhdGEpIHtcclxuICAgICAgICB6b29tSW5BQ2VsbChlbCwgZSwgZGF0YSk7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgc2NoZWR1bGVyQ3RybC5vbiA9IHtcclxuICAgICAgICBjaGFuZ2U6IChpdGVtSW5kZXgsIHNjaGVkdWxlSW5kZXgsIHNjaGVkdWxlVmFsdWUpID0+IHtcclxuICAgICAgICAgIHZhciBvbkNoYW5nZUZ1bmN0aW9uID0gdGhpcy4kcGFyc2UoYXR0cnMub25DaGFuZ2UpKHNjb3BlKTtcclxuICAgICAgICAgIGlmIChhbmd1bGFyLmlzRnVuY3Rpb24ob25DaGFuZ2VGdW5jdGlvbikpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG9uQ2hhbmdlRnVuY3Rpb24oaXRlbUluZGV4LCBzY2hlZHVsZUluZGV4LCBzY2hlZHVsZVZhbHVlKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH07XHJcblxyXG4gICAgICAvKipcclxuICAgICAgICogV2F0Y2ggdGhlIG1vZGVsIGl0ZW1zXHJcbiAgICAgICAqL1xyXG4gICAgICBzY29wZS4kd2F0Y2hDb2xsZWN0aW9uKGF0dHJzLml0ZW1zLCBvbk1vZGVsQ2hhbmdlKTtcclxuXHJcbiAgICAgIC8qKlxyXG4gICAgICAgKiBMaXN0ZW4gdG8gJGxvY2FsZSBjaGFuZ2UgKGJyb3VnaHQgYnkgZXh0ZXJuYWwgbW9kdWxlIHdlZWtseVNjaGVkdWxlckkxOE4pXHJcbiAgICAgICAqL1xyXG4gICAgICBzY29wZS4kb24oJ3dlZWtseVNjaGVkdWxlckxvY2FsZUNoYW5nZWQnLCBmdW5jdGlvbiAoZSwgbGFiZWxzKSB7XHJcbiAgICAgICAgaWYgKHNjaGVkdWxlckN0cmwuY29uZmlnKSB7XHJcbiAgICAgICAgICBzY2hlZHVsZXJDdHJsLmNvbmZpZy5sYWJlbHMgPSBsYWJlbHM7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIG9uTW9kZWxDaGFuZ2UoYW5ndWxhci5jb3B5KHRoaXMuJHBhcnNlKGF0dHJzLml0ZW1zKShzY29wZSksIFtdKSk7XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQ29uZmlndXJlIHRoZSBzY2hlZHVsZXIuXHJcbiAgICogQHBhcmFtIHNjaGVkdWxlc1xyXG4gICAqIEBwYXJhbSBvcHRpb25zXHJcbiAgICogQHJldHVybnMge3ttaW5EYXRlOiAqLCBuYkhvdXJzOiAqfX1cclxuICAgKi9cclxuICBwcml2YXRlIGNvbmZpZyhzY2hlZHVsZXM6IGFueVtdLCBvcHRpb25zKSB7XHJcbiAgICB2YXIgbm93ID0gbW9tZW50KCk7XHJcblxyXG4gICAgLy8gQ2FsY3VsYXRlIG1pbiBkYXRlIG9mIGFsbCBzY2hlZHVsZWQgZXZlbnRzXHJcbiAgICB2YXIgbWluRGF0ZSA9IChzY2hlZHVsZXMgPyBzY2hlZHVsZXMucmVkdWNlKChtaW5EYXRlLCBzbG90KSA9PiB7XHJcbiAgICAgIHJldHVybiB0aGlzLnRpbWVTZXJ2aWNlLmNvbXBhcmUoc2xvdC5zdGFydCwgJ2lzQmVmb3JlJywgbWluRGF0ZSk7XHJcbiAgICB9LCBub3cpIDogbm93KS5zdGFydE9mKCd3ZWVrJyk7XHJcblxyXG4gICAgdmFyIHJlc3VsdCA9IGFuZ3VsYXIuZXh0ZW5kKG9wdGlvbnMsIHsgbWluRGF0ZTogbWluRGF0ZSwgbmJIb3VyczogMjQgfSk7XHJcbiAgICAvLyBMb2cgY29uZmlndXJhdGlvblxyXG4gICAgdGhpcy4kbG9nLmRlYnVnKCdXZWVrbHkgU2NoZWR1bGVyIGNvbmZpZ3VyYXRpb246JywgcmVzdWx0KTtcclxuXHJcbiAgICByZXR1cm4gcmVzdWx0O1xyXG4gIH1cclxuXHJcbiAgc3RhdGljIEZhY3RvcnkoKSB7XHJcbiAgICBsZXQgZGlyZWN0aXZlID0gKCRsb2csICRwYXJzZSwgdGltZVNlcnZpY2UpID0+IG5ldyBXZWVrbHlTY2hlZHVsZXJEaXJlY3RpdmUoJGxvZywgJHBhcnNlLCB0aW1lU2VydmljZSk7XHJcblxyXG4gICAgZGlyZWN0aXZlLiRpbmplY3QgPSBbXHJcbiAgICAgICckbG9nJyxcclxuICAgICAgJyRwYXJzZScsXHJcbiAgICAgICd3ZWVrbHlTY2hlZHVsZXJUaW1lU2VydmljZSdcclxuICAgIF07XHJcblxyXG4gICAgcmV0dXJuIGRpcmVjdGl2ZTtcclxuICB9XHJcbn1cclxuXHJcbi8qIGdsb2JhbCBtb3VzZVNjcm9sbCwgQ0xJQ0tfT05fQV9DRUxMLCB6b29tSW5BQ2VsbCAqL1xyXG5hbmd1bGFyLm1vZHVsZSgnd2Vla2x5U2NoZWR1bGVyJylcclxuICAuY29udHJvbGxlcihXZWVrbHlTY2hlZHVsZXJDb250cm9sbGVyLiRuYW1lLCBXZWVrbHlTY2hlZHVsZXJDb250cm9sbGVyKVxyXG4gIC5kaXJlY3RpdmUoV2Vla2x5U2NoZWR1bGVyRGlyZWN0aXZlLiRuYW1lLCBXZWVrbHlTY2hlZHVsZXJEaXJlY3RpdmUuRmFjdG9yeSgpKTtcclxuIiwiY2xhc3MgV2Vla2x5U2xvdERpcmVjdGl2ZSBpbXBsZW1lbnRzIGFuZ3VsYXIuSURpcmVjdGl2ZSB7XHJcbiAgc3RhdGljICRuYW1lID0gJ3dlZWtseVNsb3QnO1xyXG5cclxuICBjb25zdHJ1Y3RvcihcclxuICAgIHByaXZhdGUgdGltZVNlcnZpY2U6IFdlZWtseVNjaGVkdWxlclRpbWVTZXJ2aWNlXHJcbiAgKSB7XHJcbiAgfVxyXG5cclxuICByZXN0cmljdCA9ICdFJztcclxuICByZXF1aXJlID0gWyded2Vla2x5U2NoZWR1bGVyJywgJ25nTW9kZWwnXTtcclxuICB0ZW1wbGF0ZVVybCA9ICduZy13ZWVrbHktc2NoZWR1bGVyL3dlZWtseS1zbG90L3dlZWtseS1zbG90Lmh0bWwnO1xyXG5cclxuICBsaW5rID0gKHNjb3BlLCBlbGVtZW50OiBhbmd1bGFyLklBdWdtZW50ZWRKUXVlcnksIGF0dHJzOiBhbmd1bGFyLklBdHRyaWJ1dGVzLCBjdHJscykgPT4ge1xyXG4gICAgdmFyIHNjaGVkdWxlckN0cmw6IFdlZWtseVNjaGVkdWxlckNvbnRyb2xsZXIgPSBjdHJsc1swXSxcclxuICAgICAgICBuZ01vZGVsQ3RybDogYW5ndWxhci5JTmdNb2RlbENvbnRyb2xsZXIgPSBjdHJsc1sxXTtcclxuXHJcbiAgICB2YXIgY29uZiA9IHNjaGVkdWxlckN0cmwuY29uZmlnO1xyXG4gICAgdmFyIGluZGV4ID0gc2NvcGUuJHBhcmVudC4kaW5kZXg7XHJcbiAgICB2YXIgY29udGFpbmVyRWwgPSBlbGVtZW50LnBhcmVudCgpO1xyXG4gICAgdmFyIHJlc2l6ZURpcmVjdGlvbklzU3RhcnQgPSB0cnVlO1xyXG4gICAgdmFyIHZhbHVlc09uRHJhZ1N0YXJ0ID0ge3N0YXJ0OiBzY29wZS5zY2hlZHVsZS5zdGFydCwgZW5kOiBzY29wZS5zY2hlZHVsZS5lbmR9O1xyXG5cclxuICAgIHZhciBwaXhlbFRvVmFsID0gZnVuY3Rpb24gKHBpeGVsKSB7XHJcbiAgICAgIHZhciBwZXJjZW50ID0gcGl4ZWwgLyBjb250YWluZXJFbFswXS5jbGllbnRXaWR0aDtcclxuICAgICAgcmV0dXJuIE1hdGguZmxvb3IocGVyY2VudCAqIGNvbmYubmJIb3VycyArIDAuNSk7XHJcbiAgICB9O1xyXG5cclxuICAgIHZhciBtZXJnZU92ZXJsYXBzID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICB2YXIgc2NoZWR1bGUgPSBzY29wZS5zY2hlZHVsZTtcclxuICAgICAgdmFyIHNjaGVkdWxlcyA9IHNjb3BlLml0ZW0uc2NoZWR1bGVzO1xyXG4gICAgICBzY2hlZHVsZXMuZm9yRWFjaChmdW5jdGlvbiAoZWwpIHtcclxuICAgICAgICBpZiAoZWwgIT09IHNjaGVkdWxlKSB7XHJcbiAgICAgICAgICAvLyBtb2RlbCBpcyBpbnNpZGUgYW5vdGhlciBzbG90XHJcbiAgICAgICAgICBpZiAoZWwuZW5kID49IHNjaGVkdWxlLmVuZCAmJiBlbC5zdGFydCA8PSBzY2hlZHVsZS5zdGFydCkge1xyXG4gICAgICAgICAgICBzY2hlZHVsZXMuc3BsaWNlKHNjaGVkdWxlcy5pbmRleE9mKGVsKSwgMSk7XHJcbiAgICAgICAgICAgIHNjaGVkdWxlLmVuZCA9IGVsLmVuZDtcclxuICAgICAgICAgICAgc2NoZWR1bGUuc3RhcnQgPSBlbC5zdGFydDtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIC8vIG1vZGVsIGNvbXBsZXRlbHkgY292ZXJzIGFub3RoZXIgc2xvdFxyXG4gICAgICAgICAgZWxzZSBpZiAoc2NoZWR1bGUuZW5kID49IGVsLmVuZCAmJiBzY2hlZHVsZS5zdGFydCA8PSBlbC5zdGFydCkge1xyXG4gICAgICAgICAgICBzY2hlZHVsZXMuc3BsaWNlKHNjaGVkdWxlcy5pbmRleE9mKGVsKSwgMSk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICAvLyBhbm90aGVyIHNsb3QncyBlbmQgaXMgaW5zaWRlIGN1cnJlbnQgbW9kZWxcclxuICAgICAgICAgIGVsc2UgaWYgKGVsLmVuZCA+PSBzY2hlZHVsZS5zdGFydCAmJiBlbC5lbmQgPD0gc2NoZWR1bGUuZW5kKSB7XHJcbiAgICAgICAgICAgIHNjaGVkdWxlcy5zcGxpY2Uoc2NoZWR1bGVzLmluZGV4T2YoZWwpLCAxKTtcclxuICAgICAgICAgICAgc2NoZWR1bGUuc3RhcnQgPSBlbC5zdGFydDtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIC8vIGFub3RoZXIgc2xvdCdzIHN0YXJ0IGlzIGluc2lkZSBjdXJyZW50IG1vZGVsXHJcbiAgICAgICAgICBlbHNlIGlmIChlbC5zdGFydCA+PSBzY2hlZHVsZS5zdGFydCAmJiBlbC5zdGFydCA8PSBzY2hlZHVsZS5lbmQpIHtcclxuICAgICAgICAgICAgc2NoZWR1bGVzLnNwbGljZShzY2hlZHVsZXMuaW5kZXhPZihlbCksIDEpO1xyXG4gICAgICAgICAgICBzY2hlZHVsZS5lbmQgPSBlbC5lbmQ7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgIH07XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBEZWxldGUgb24gcmlnaHQgY2xpY2sgb24gc2xvdFxyXG4gICAgICovXHJcbiAgICB2YXIgZGVsZXRlU2VsZiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgY29udGFpbmVyRWwucmVtb3ZlQ2xhc3MoJ2RyYWdnaW5nJyk7XHJcbiAgICAgIGNvbnRhaW5lckVsLnJlbW92ZUNsYXNzKCdzbG90LWhvdmVyJyk7XHJcbiAgICAgIHNjb3BlLml0ZW0uc2NoZWR1bGVzLnNwbGljZShzY29wZS5pdGVtLnNjaGVkdWxlcy5pbmRleE9mKHNjb3BlLnNjaGVkdWxlKSwgMSk7XHJcbiAgICAgIGNvbnRhaW5lckVsLmZpbmQoJ3dlZWtseS1zbG90JykucmVtb3ZlKCk7XHJcbiAgICAgIHNjb3BlLiRhcHBseSgpO1xyXG4gICAgfTtcclxuXHJcbiAgICBlbGVtZW50LmZpbmQoJ3NwYW4nKS5vbignY2xpY2snLCBmdW5jdGlvbiAoZSkge1xyXG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIGRlbGV0ZVNlbGYoKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGVsZW1lbnQub24oJ21vdXNlb3ZlcicsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgY29udGFpbmVyRWwuYWRkQ2xhc3MoJ3Nsb3QtaG92ZXInKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGVsZW1lbnQub24oJ21vdXNlbGVhdmUnLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIGNvbnRhaW5lckVsLnJlbW92ZUNsYXNzKCdzbG90LWhvdmVyJyk7XHJcbiAgICB9KTtcclxuXHJcblxyXG4gICAgaWYgKHNjb3BlLml0ZW0uZWRpdGFibGUgIT09IGZhbHNlKSB7XHJcbiAgICAgIHNjb3BlLnN0YXJ0UmVzaXplU3RhcnQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmVzaXplRGlyZWN0aW9uSXNTdGFydCA9IHRydWU7XHJcbiAgICAgICAgc2NvcGUuc3RhcnREcmFnKCk7XHJcbiAgICAgIH07XHJcblxyXG4gICAgICBzY29wZS5zdGFydFJlc2l6ZUVuZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXNpemVEaXJlY3Rpb25Jc1N0YXJ0ID0gZmFsc2U7XHJcbiAgICAgICAgc2NvcGUuc3RhcnREcmFnKCk7XHJcbiAgICAgIH07XHJcblxyXG4gICAgICBzY29wZS5zdGFydERyYWcgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgZWxlbWVudC5hZGRDbGFzcygnYWN0aXZlJyk7XHJcblxyXG4gICAgICAgIGNvbnRhaW5lckVsLmFkZENsYXNzKCdkcmFnZ2luZycpO1xyXG4gICAgICAgIGNvbnRhaW5lckVsLmF0dHIoJ25vLWFkZCcsICd0cnVlJyk7XHJcblxyXG4gICAgICAgIHZhbHVlc09uRHJhZ1N0YXJ0ID0ge3N0YXJ0OiBuZ01vZGVsQ3RybC4kdmlld1ZhbHVlLnN0YXJ0LCBlbmQ6IG5nTW9kZWxDdHJsLiR2aWV3VmFsdWUuZW5kfTtcclxuICAgICAgfTtcclxuXHJcbiAgICAgIHNjb3BlLmVuZERyYWcgPSBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICAgIC8vIHRoaXMgcHJldmVudHMgdXNlciBmcm9tIGFjY2lkZW50YWxseVxyXG4gICAgICAgIC8vIGFkZGluZyBuZXcgc2xvdCBhZnRlciByZXNpemluZyBvciBkcmFnZ2luZ1xyXG4gICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgY29udGFpbmVyRWwucmVtb3ZlQXR0cignbm8tYWRkJyk7XHJcbiAgICAgICAgfSwgNTAwKTtcclxuXHJcbiAgICAgICAgZWxlbWVudC5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XHJcbiAgICAgICAgY29udGFpbmVyRWwucmVtb3ZlQ2xhc3MoJ2RyYWdnaW5nJyk7XHJcblxyXG4gICAgICAgIG1lcmdlT3ZlcmxhcHMoKTtcclxuICAgICAgICBzY29wZS4kYXBwbHkoKTtcclxuICAgICAgfTtcclxuXHJcbiAgICAgIHNjb3BlLnJlc2l6ZSA9IGZ1bmN0aW9uIChkKSB7XHJcbiAgICAgICAgdmFyIHVpID0gbmdNb2RlbEN0cmwuJHZpZXdWYWx1ZTtcclxuICAgICAgICB2YXIgZGVsdGEgPSBwaXhlbFRvVmFsKGQpO1xyXG5cclxuICAgICAgICBpZiAocmVzaXplRGlyZWN0aW9uSXNTdGFydCkge1xyXG4gICAgICAgICAgdmFyIG5ld1N0YXJ0ID0gTWF0aC5yb3VuZCh2YWx1ZXNPbkRyYWdTdGFydC5zdGFydCArIGRlbHRhKTtcclxuXHJcbiAgICAgICAgICBpZiAodWkuc3RhcnQgIT09IG5ld1N0YXJ0ICYmIG5ld1N0YXJ0IDw9IHVpLmVuZCAtIDEgJiYgbmV3U3RhcnQgPj0gMCkge1xyXG4gICAgICAgICAgICBuZ01vZGVsQ3RybC4kc2V0Vmlld1ZhbHVlKHtcclxuICAgICAgICAgICAgICBzdGFydDogbmV3U3RhcnQsXHJcbiAgICAgICAgICAgICAgZW5kOiB1aS5lbmRcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIG5nTW9kZWxDdHJsLiRyZW5kZXIoKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgdmFyIG5ld0VuZCA9IE1hdGgucm91bmQodmFsdWVzT25EcmFnU3RhcnQuZW5kICsgZGVsdGEpO1xyXG5cclxuICAgICAgICAgIGlmICh1aS5lbmQgIT09IG5ld0VuZCAmJiBuZXdFbmQgPj0gdWkuc3RhcnQgKyAxICYmIG5ld0VuZCA8PSBjb25mLm5iSG91cnMpIHtcclxuICAgICAgICAgICAgbmdNb2RlbEN0cmwuJHNldFZpZXdWYWx1ZSh7XHJcbiAgICAgICAgICAgICAgc3RhcnQ6IHVpLnN0YXJ0LFxyXG4gICAgICAgICAgICAgIGVuZDogbmV3RW5kXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBuZ01vZGVsQ3RybC4kcmVuZGVyKCk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9O1xyXG5cclxuICAgICAgc2NvcGUuZHJhZyA9IGZ1bmN0aW9uIChkKSB7XHJcbiAgICAgICAgdmFyIHVpID0gbmdNb2RlbEN0cmwuJHZpZXdWYWx1ZTtcclxuICAgICAgICB2YXIgZGVsdGEgPSBwaXhlbFRvVmFsKGQpO1xyXG4gICAgICAgIHZhciBkdXJhdGlvbiA9IHZhbHVlc09uRHJhZ1N0YXJ0LmVuZCAtIHZhbHVlc09uRHJhZ1N0YXJ0LnN0YXJ0O1xyXG5cclxuICAgICAgICB2YXIgbmV3U3RhcnQgPSBNYXRoLnJvdW5kKHZhbHVlc09uRHJhZ1N0YXJ0LnN0YXJ0ICsgZGVsdGEpO1xyXG4gICAgICAgIHZhciBuZXdFbmQgPSBNYXRoLnJvdW5kKG5ld1N0YXJ0ICsgZHVyYXRpb24pO1xyXG5cclxuICAgICAgICBpZiAodWkuc3RhcnQgIT09IG5ld1N0YXJ0ICYmIG5ld1N0YXJ0ID49IDAgJiYgbmV3RW5kIDw9IGNvbmYubmJIb3Vycykge1xyXG4gICAgICAgICAgbmdNb2RlbEN0cmwuJHNldFZpZXdWYWx1ZSh7XHJcbiAgICAgICAgICAgIHN0YXJ0OiBuZXdTdGFydCxcclxuICAgICAgICAgICAgZW5kOiBuZXdFbmRcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgbmdNb2RlbEN0cmwuJHJlbmRlcigpO1xyXG4gICAgICAgIH1cclxuICAgICAgfTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBvbiBpbml0LCBtZXJnZSBvdmVybGFwc1xyXG4gICAgbWVyZ2VPdmVybGFwcygpO1xyXG5cclxuICAgIC8vLy8gVUkgLT4gbW9kZWwgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXHJcbiAgICBuZ01vZGVsQ3RybC4kcGFyc2Vycy5wdXNoKCh1aSkgPT4ge1xyXG4gICAgICBuZ01vZGVsQ3RybC4kbW9kZWxWYWx1ZS5zdGFydCA9IHRoaXMudGltZVNlcnZpY2UuYWRkSG91cihjb25mLm1pbkRhdGUsIHVpLnN0YXJ0KS50b0RhdGUoKTtcclxuICAgICAgbmdNb2RlbEN0cmwuJG1vZGVsVmFsdWUuZW5kID0gdGhpcy50aW1lU2VydmljZS5hZGRIb3VyKGNvbmYubWluRGF0ZSwgdWkuZW5kKS50b0RhdGUoKTtcclxuICAgICAgLy8kbG9nLmRlYnVnKCdQQVJTRVIgOicsIG5nTW9kZWxDdHJsLiRtb2RlbFZhbHVlLiQkaGFzaEtleSwgaW5kZXgsIHNjb3BlLiRpbmRleCwgbmdNb2RlbEN0cmwuJG1vZGVsVmFsdWUpO1xyXG4gICAgICBzY2hlZHVsZXJDdHJsLm9uLmNoYW5nZShpbmRleCwgc2NvcGUuJGluZGV4LCBuZ01vZGVsQ3RybC4kbW9kZWxWYWx1ZSk7XHJcbiAgICAgIHJldHVybiBuZ01vZGVsQ3RybC4kbW9kZWxWYWx1ZTtcclxuICAgIH0pO1xyXG5cclxuICAgIC8vLy8gbW9kZWwgLT4gVUkgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXHJcbiAgICBuZ01vZGVsQ3RybC4kZm9ybWF0dGVycy5wdXNoKChtb2RlbCkgPT4ge1xyXG4gICAgICB2YXIgdWkgPSB7XHJcbiAgICAgICAgc3RhcnQ6IHRoaXMudGltZVNlcnZpY2UuaG91clByZWNpc2VEaWZmKGNvbmYubWluRGF0ZSwgbW9tZW50KG1vZGVsLnN0YXJ0KSksXHJcbiAgICAgICAgZW5kOiB0aGlzLnRpbWVTZXJ2aWNlLmhvdXJQcmVjaXNlRGlmZihjb25mLm1pbkRhdGUsIG1vbWVudChtb2RlbC5lbmQpKVxyXG4gICAgICB9O1xyXG4gICAgICAvLyRsb2cuZGVidWcoJ0ZPUk1BVFRFUiA6JywgaW5kZXgsIHNjb3BlLiRpbmRleCwgdWkpO1xyXG4gICAgICByZXR1cm4gdWk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBuZ01vZGVsQ3RybC4kcmVuZGVyID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICB2YXIgdWkgPSBuZ01vZGVsQ3RybC4kdmlld1ZhbHVlO1xyXG4gICAgICB2YXIgY3NzID0ge1xyXG4gICAgICAgIGxlZnQ6IHVpLnN0YXJ0IC8gY29uZi5uYkhvdXJzKiAxMDAgKyAnJScsXHJcbiAgICAgICAgd2lkdGg6ICh1aS5lbmQgLSB1aS5zdGFydCkgLyBjb25mLm5iSG91cnMgKiAxMDAgKyAnJSdcclxuICAgICAgfTtcclxuXHJcbiAgICAgIC8vJGxvZy5kZWJ1ZygnUkVOREVSIDonLCBpbmRleCwgc2NvcGUuJGluZGV4LCBjc3MpO1xyXG4gICAgICBlbGVtZW50LmNzcyhjc3MpO1xyXG4gICAgfTtcclxuXHJcbiAgICBzY29wZS4kb24oJ3dlZWtseVNjaGVkdWxlckxvY2FsZUNoYW5nZWQnLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIC8vIFNpbXBsZSBjaGFuZ2Ugb2JqZWN0IHJlZmVyZW5jZSBzbyB0aGF0IG5nTW9kZWwgdHJpZ2dlcnMgZm9ybWF0dGluZyAmIHJlbmRlcmluZ1xyXG4gICAgICBzY29wZS5zY2hlZHVsZSA9IGFuZ3VsYXIuY29weShzY29wZS5zY2hlZHVsZSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIHN0YXRpYyBGYWN0b3J5KCkge1xyXG4gICAgbGV0IGRpcmVjdGl2ZSA9ICh0aW1lU2VydmljZSkgPT4gbmV3IFdlZWtseVNsb3REaXJlY3RpdmUodGltZVNlcnZpY2UpO1xyXG5cclxuICAgIGRpcmVjdGl2ZS4kaW5qZWN0ID0gWyd3ZWVrbHlTY2hlZHVsZXJUaW1lU2VydmljZSddO1xyXG5cclxuICAgIHJldHVybiBkaXJlY3RpdmU7XHJcbiAgfVxyXG59XHJcblxyXG5hbmd1bGFyXHJcbiAgLm1vZHVsZSgnd2Vla2x5U2NoZWR1bGVyJylcclxuICAuZGlyZWN0aXZlKFdlZWtseVNsb3REaXJlY3RpdmUuJG5hbWUsIFdlZWtseVNsb3REaXJlY3RpdmUuRmFjdG9yeSgpKTtcclxuIl19

angular.module('ngWeeklySchedulerTemplates', []).run(['$templateCache', function($templateCache) {$templateCache.put('index.html','<!doctype html><html lang="en"><head><meta charset="UTF-8"><title>Angularjs weekly scheduler demo</title><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/github-fork-ribbon-css/0.2.0/gh-fork-ribbon.min.css"><!--[if lt IE 9]>\r\n  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/github-fork-ribbon-css/0.2.0/gh-fork-ribbon.ie.min.css"/>\r\n  <![endif]--><link rel="stylesheet" href="testStyles.css"></head><body class="container-fluid" ng-app="demoApp"><a class="github-fork-ribbon" href="https://github.com/fmaturel/angular-weekly-scheduler" title="Fork me on GitHub">Fork me on GitHub</a><nav class="navbar navbar-default"><div class="container-fluid"><div class="navbar-header"><button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false"><span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span></button> <a class="navbar-brand" href="#">dijit</a></div><div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1"><ul class="nav navbar-nav"><li class="active"><a href="#demo">Demo <span class="sr-only">(current)</span></a></li><li><a href="#run">Run @ Home</a></li><li><a href="#install">Install</a></li><li><a href="#features">Features</a></li></ul></div></div></nav><div class="row" ng-controller="DemoController as demo"><div class="col-xs-10 col-xs-offset-1"><h1>Angularjs weekly scheduler</h1><h2 id="demo" class="page-header">1. Demo</h2><div><label for="language">Choose your language:</label><select id="language" ng-model="model.locale" ng-change="demo.onLocaleChange()"><option value="en-us" selected="selected">us</option><option value="en-gb" selected="selected">gb</option><option value="fr-fr">fr</option><option value="de-de">de</option><option value="es-es">es (lang customized in demo)</option></select></div><div><code>$scope.model</code><pre ng-bind="model | json" style="max-height: 200px"></pre></div><weekly-scheduler class="scheduler" items="model.items" on-change="demo.doSomething" on-delete="demo.doSomething" options="model.options"><div class="srow">{{::$index + 1}}. {{item.label}}</div></weekly-scheduler><div class="pull-right"><button class="btn btn-success" role="button" ng-click="model.items.push({label: \'New Item\'})">Add new item</button></div><h2 id="run" class="page-header">2. Run @ Home</h2><p>Run the demo @home with few steps (prerequisite git & node V0.10+ & npm installed):</p><pre>\r\ngit clone https://github.com/fmaturel/angular-weekly-scheduler.git && cd angular-weekly-scheduler\r\nnpm install\r\nnpm install -g grunt-cli</pre><p>Then run <code>grunt serve:dist</code></p><h2 id="install" class="page-header">3. Install</h2><p><code>bower install --save angular-weekly-scheduler</code></p><p>or</p><p><code>npm install --save angular-weekly-scheduler</code></p><p>Add the scripts and css to your index.html. The angular-locale_xx-xx.js file is your locale file</p><pre>\r\n&lt;link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css"&gt;\r\n&lt;script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.4.10/angular.min.js"&gt;&lt;/script&gt;\r\n&lt;script src="https://cdnjs.cloudflare.com/ajax/libs/angular-i18n/1.4.10/angular-locale_xx-xx.js"&gt;&lt;/script&gt;\r\n&lt;script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.13.0/moment.js"&gt;&lt;/script&gt;\r\n\r\n&lt;!-- The library to replace with your local copy of ng-weekly-scheduler --&gt;\r\n&lt;script src="https://github.com/fmaturel/angular-weekly-scheduler/blob/master/dist/js/ng-weekly-scheduler.js"&gt;&lt;/script&gt;</pre><p>Add dependency to timeline your angular module: weeklyScheduler.</p><p>Use the directive:</p><code>&lt;weekly-scheduler class="scheduler" ng-model="myScopeModel" options="options"&gt;&lt;/weekly-scheduler&gt;</code><h2 id="features" class="page-header">4. Features</h2><p>This directive displays a weekly item scheduler. You can see, add and modify items easily.</p><h3>Keyboard shortcuts</h3><ul><li>Use <kbd>mouse wheel</kbd> on schedule to scroll left and right</li><li>Use <kbd>ctrl + mouse wheel</kbd> to zoom in and out the schedule</li></ul><hr><h3>Schedules</h3><div class="alert alert-info alert-dismissible fade in" role="alert">This directive uses <a href="http://momentjs.com/"><strong>MomentJS</strong></a> to position items and calculate localized calendar weeks.</div><p>Drag the time bar start, end and body to quickly change your schedule period.</p><p>You can set an <code>editable</code> variable on each item, that will be used to disable item edition if <code>false</code>.<pre>\r\n"items": [{\r\n  "label": "Item 1",\r\n  "editable": false,\r\n  "schedules": [\r\n    {\r\n      "start": "2015-12-26T23:00:00.000Z",\r\n      "end": "2016-07-31T22:00:00.000Z"\r\n    }\r\n  ]\r\n}, ...]</pre></p><hr><h3>Transclusion</h3><p>This directive is using <code>ng-transclude</code> so that everything in <code>&lt;weekly-scheduler&gt;</code> element will be treated as the labelling object of one item.</p><pre>&lt;div class="srow"&gt;\\{\\{::$index + 1\\}\\}. \\{\\{ item.label \\}\\}&lt;/div&gt;</pre><p>On transcluded item label, the scope contains <code>item</code> attribute name containing each item model and regular <code>ng-repeat</code> scope attributes</p><h3>Internationalisation (i18n)</h3><p>I18N uses <a href="https://github.com/lgalfaso/angular-dynamic-locale">dynamic angular <code>$locale</code> change</a>.</p><p>An i18n module named <code>weeklySchedulerI18N</code> is optionally registered when using the core module :</p><pre>angular.module(\'demoApp\', [\'weeklyScheduler\', \'weeklySchedulerI18N\'])</pre><p>If present, core directive will retrieve current <code>$locale</code> and use it to translate labelling elements.</p><p>You can add more <code>$locale</code> translation using provider <code>weeklySchedulerLocaleServiceProvider</code>:</p><pre>\r\nangular.module(\'demoApp\', [\'weeklyScheduler\', \'weeklySchedulerI18N\'])\r\n  .config([\'weeklySchedulerLocaleServiceProvider\', function (localeServiceProvider) {\r\n    localeServiceProvider.configure({\r\n      doys: {\'es-es\': 4},\r\n      lang: {\'es-es\': {weekNb: \'n\xFAmero de la semana\', addNew: \'A\xF1adir\'}},\r\n      localeLocationPattern: \'/vendor/angular-i18n/angular-locale_{{locale}}.js\'\r\n    });\r\n  }])</pre><h3>Animation</h3><p>You can add animation to the weekly scheduler directive easily by importing angular module <code>ngAnimate</code>.<br>Your application could for instance use :</p><pre>angular.module(\'demoApp\', [\'ngAnimate\', \'weeklyScheduler\'])</pre><p>Don\'t forget to add the angular-animate javascript file to your Single Page App <code>index.html</code>.</p><pre>&lt;script src="/vendor/angular-animate/angular-animate.js"&gt;&lt;/script&gt;</pre><p>Styling can be changed to whatever you like. This is an example of fading-in items entering the DOM :</p><pre>.schedule-animate {\r\n  transition: opacity 200ms ease-out;\r\n}\r\n.schedule-animate.ng-enter, .schedule-animate.ng-hide-remove {\r\n  opacity: 0;\r\n}\r\n.schedule-animate.ng-leave, .schedule-animate.ng-hide-add {\r\n  display: none;\r\n  opacity: 1;\r\n}</pre><p>You should see your scheduler items fading in!</p></div></div><script src="testVendorScripts.js"></script><script src="testScripts.js"></script><script>(function (i, s, o, g, r, a, m) {\r\n    i[\'GoogleAnalyticsObject\'] = r;\r\n    i[r] = i[r] || function () {\r\n        (i[r].q = i[r].q || []).push(arguments)\r\n      }, i[r].l = 1 * new Date();\r\n    a = s.createElement(o),\r\n      m = s.getElementsByTagName(o)[0];\r\n    a.async = 1;\r\n    a.src = g;\r\n    m.parentNode.insertBefore(a, m)\r\n  })(window, document, \'script\', \'https://www.google-analytics.com/analytics.js\', \'ga\');\r\n\r\n  ga(\'create\', \'UA-22755333-1\', \'auto\');\r\n  ga(\'send\', \'pageview\');</script></body></html>');
$templateCache.put('ng-weekly-scheduler/multislider/multislider.html','<div class="slot ghost" ng-show="item.editable !== false && (!schedulerCtrl.config.monoSchedule || !item.schedules.length)">{{schedulerCtrl.config.labels.addNew || \'Add New\'}}</div><weekly-slot class="slot" ng-class="{disable: item.editable === false}" ng-repeat="schedule in item.schedules" ng-model="schedule" ng-model-options="{ updateOn: \'default blur\', debounce: { \'default\': 500, \'blur\': 0 } }"></weekly-slot>');
$templateCache.put('ng-weekly-scheduler/weekly-scheduler/weekly-scheduler.html','<div class="labels"><div class="srow text-right"></div><div class="schedule-animate" ng-repeat="item in schedulerCtrl.items" inject></div></div><div class="schedule-area-container"><div class="schedule-area"><div class="srow timestamps"><hourly-grid class="grid-container"></hourly-grid></div><div class="srow schedule-animate" ng-repeat="item in schedulerCtrl.items"><hourly-grid class="grid-container striped" no-text></hourly-grid><multi-slider index="{{$index}}"></multi-slider></div></div></div>');
$templateCache.put('ng-weekly-scheduler/weekly-slot/weekly-slot.html','<div title="{{schedule.start | date}} - {{schedule.end | date}}"><div class="handle left" ondrag="resize" ondragstart="startResizeStart" ondragstop="endDrag" handle></div><div ondrag="drag" ondragstart="startDrag" ondragstop="endDrag" handle>{{schedule.start | date}} - {{schedule.end | date}}</div><div class="handle right" ondrag="resize" ondragstart="startResizeEnd" ondragstop="endDrag" handle></div><div class="remove"><span class="glyphicon glyphicon-remove"></span></div></div>');}]);